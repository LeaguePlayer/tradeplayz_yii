/*! Fabric.js Copyright 2008-2013, Printio (Juriy Zaytsev, Maxim Chernyak) */
var fabric=fabric||{version:"1.1.6"};if(typeof exports!=="undefined"){exports.fabric=fabric}if(typeof document!=="undefined"&&typeof window!=="undefined"){fabric.document=document;fabric.window=window}else{fabric.document=require("jsdom").jsdom("<!DOCTYPE html><html><head></head><body></body></html>");fabric.window=fabric.document.createWindow()}fabric.isTouchSupported="ontouchstart" in fabric.document.documentElement;fabric.isLikelyNode=typeof Buffer!=="undefined"&&typeof window==="undefined";fabric.log=function(){};fabric.warn=function(){};if(typeof console!=="undefined"){if(typeof console.log!=="undefined"&&console.log.apply){fabric.log=function(){return console.log.apply(console,arguments)}}if(typeof console.warn!=="undefined"&&console.warn.apply){fabric.warn=function(){return console.warn.apply(console,arguments)}}}fabric.Observable={observe:function(a,b){if(!this.__eventListeners){this.__eventListeners={}}if(arguments.length===1){for(var c in a){this.on(c,a[c])}}else{if(!this.__eventListeners[a]){this.__eventListeners[a]=[]}this.__eventListeners[a].push(b)}},stopObserving:function(a,b){if(!this.__eventListeners){this.__eventListeners={}}if(this.__eventListeners[a]){if(b){fabric.util.removeFromArray(this.__eventListeners[a],b)}else{this.__eventListeners[a].length=0}}},fire:function(c,d){if(!this.__eventListeners){this.__eventListeners={}}var b=this.__eventListeners[c];if(!b){return}for(var e=0,a=b.length;e<a;e++){b[e](d||{})}}};fabric.Observable.on=fabric.Observable.observe;fabric.Observable.off=fabric.Observable.stopObserving;fabric.Observable.trigger=fabric.Observable.fire;fabric.Collection={add:function(){this._objects.push.apply(this._objects,arguments);for(var a=arguments.length;a--;){this._onObjectAdded(arguments[a])}this.renderOnAddition&&this.renderAll();return this},insertAt:function(b,a,d){var c=this.getObjects();if(d){c[a]=b}else{c.splice(a,0,b)}this._onObjectAdded(b);this.renderOnAddition&&this.renderAll();return this},remove:function(b){var c=this.getObjects();var a=c.indexOf(b);if(a!==-1){c.splice(a,1);this._onObjectRemoved(b)}this.renderAll&&this.renderAll();return b},forEachObject:function(d,b){var c=this.getObjects(),a=c.length;while(a--){d.call(b,c[a],a,c)}return this},item:function(a){return this.getObjects()[a]},isEmpty:function(){return this.getObjects().length===0},size:function(){return this.getObjects().length},contains:function(a){return this.getObjects().indexOf(a)>-1},complexity:function(){return this.getObjects().reduce(function(a,b){a+=b.complexity?b.complexity():0;return a},0)},toGrayscale:function(){return this.forEachObject(function(a){a.toGrayscale()})}};(function(){var u=Math.sqrt,c=Math.atan2;fabric.util={};function o(x,w){var v=x.indexOf(w);if(v!==-1){x.splice(v,1)}return x}function g(w,v){return Math.floor(Math.random()*(v-w+1))+w}var a=Math.PI/180;function r(v){return v*a}function l(v){return v/a}function i(v,x,B){var w=Math.sin(B),z=Math.cos(B);v.subtractEquals(x);var A=v.x*z-v.y*w;var y=v.x*w+v.y*z;return new fabric.Point(A,y).addEquals(x)}function q(w,v){return parseFloat(Number(w).toFixed(v))}function n(){return false}function h(G){G||(G={});var w=+new Date(),y=G.duration||500,E=w+y,x,B=G.onChange||function(){},z=G.abort||function(){return false},C=G.easing||function(I,H,K,J){return -K*Math.cos(I/J*(Math.PI/2))+K+H},v="startValue" in G?G.startValue:0,D="endValue" in G?G.endValue:100,F=G.byValue||D-v;G.onStart&&G.onStart();(function A(){x=+new Date();var H=x>E?y:(x-w);B(C(H,v,F,y));if(x>E||z()){G.onComplete&&G.onComplete();return}f(A)})()}var s=fabric.window.requestAnimationFrame||fabric.window.webkitRequestAnimationFrame||fabric.window.mozRequestAnimationFrame||fabric.window.oRequestAnimationFrame||fabric.window.msRequestAnimationFrame||function(v){fabric.window.setTimeout(v,1000/60)};var f=function(){return s.apply(fabric.window,arguments)};function d(w,y,x){if(w){var v=new Image();v.onload=function(){y&&y.call(x,v);v=v.onload=null};v.src=w}else{y&&y.call(x,w)}}function k(y,B){function x(C){return fabric[fabric.util.string.camelize(fabric.util.string.capitalize(C))]}function w(){if(++A===v){if(B){B(z)}}}var z=[],A=0,v=y.length;y.forEach(function(E,D){if(!E.type){return}var C=x(E.type);if(C.async){C.fromObject(E,function(G,F){if(!F){z[D]=G}w()})}else{z[D]=C.fromObject(E);w()}})}function t(y,w,z){var v;if(y.length>1){var x=y.some(function(A){return A.type==="text"});if(x){v=new fabric.Group([],w);y.reverse().forEach(function(A){if(A.cx){A.left=A.cx}if(A.cy){A.top=A.cy}v.addWithUpdate(A)})}else{v=new fabric.PathGroup(y,w)}}else{v=y[0]}if(typeof z!=="undefined"){v.setSourcePath(z)}return v}function p(z,w,y){if(y&&Object.prototype.toString.call(y)==="[object Array]"){for(var x=0,v=y.length;x<v;x++){w[y[x]]=z[y[x]]}}}function j(G,E,B,v,C,I){var J=v-E,H=C-B,z=u(J*J+H*H),w=c(H,J),F=I.length,A=0,D=true;G.save();G.translate(E,B);G.moveTo(0,0);G.rotate(w);E=0;while(z>E){E+=I[A++%F];if(E>z){E=z}G[D?"lineTo":"moveTo"](E,0);D=!D}G.restore()}function e(v){v||(v=fabric.document.createElement("canvas"));if(!v.getContext&&typeof G_vmlCanvasManager!=="undefined"){G_vmlCanvasManager.initElement(v)}return v}function b(v){var z=v.prototype;for(var x=z.stateProperties.length;x--;){var A=z.stateProperties[x],B=A.charAt(0).toUpperCase()+A.slice(1),w="set"+B,y="get"+B;if(!z[y]){z[y]=(function(C){return new Function('return this.get("'+C+'")')})(A)}if(!z[w]){z[w]=(function(C){return new Function("value",'return this.set("'+C+'", value)')})(A)}}}function m(w,v){v.save();v.beginPath();w.clipTo(v);v.clip()}fabric.util.removeFromArray=o;fabric.util.degreesToRadians=r;fabric.util.radiansToDegrees=l;fabric.util.rotatePoint=i;fabric.util.toFixed=q;fabric.util.getRandomInt=g;fabric.util.falseFunction=n;fabric.util.animate=h;fabric.util.requestAnimFrame=f;fabric.util.loadImage=d;fabric.util.enlivenObjects=k;fabric.util.groupSVGElements=t;fabric.util.populateWithProperties=p;fabric.util.drawDashedLine=j;fabric.util.createCanvasElement=e;fabric.util.createAccessors=b;fabric.util.clipContext=m})();(function(){var d=Array.prototype.slice;if(!Array.prototype.indexOf){Array.prototype.indexOf=function(g){if(this===void 0||this===null){throw new TypeError()}var h=Object(this),e=h.length>>>0;if(e===0){return -1}var i=0;if(arguments.length>0){i=Number(arguments[1]);if(i!==i){i=0}else{if(i!==0&&i!==Number.POSITIVE_INFINITY&&i!==Number.NEGATIVE_INFINITY){i=(i>0||-1)*Math.floor(Math.abs(i))}}}if(i>=e){return -1}var f=i>=0?i:Math.max(e-Math.abs(i),0);for(;f<e;f++){if(f in h&&h[f]===g){return f}}return -1}}if(!Array.prototype.forEach){Array.prototype.forEach=function(h,g){for(var f=0,e=this.length>>>0;f<e;f++){if(f in this){h.call(g,this[f],f,this)}}}}if(!Array.prototype.map){Array.prototype.map=function(j,h){var f=[];for(var g=0,e=this.length>>>0;g<e;g++){if(g in this){f[g]=j.call(h,this[g],g,this)}}return f}}if(!Array.prototype.every){Array.prototype.every=function(h,g){for(var f=0,e=this.length>>>0;f<e;f++){if(f in this&&!h.call(g,this[f],f,this)){return false}}return true}}if(!Array.prototype.some){Array.prototype.some=function(h,g){for(var f=0,e=this.length>>>0;f<e;f++){if(f in this&&h.call(g,this[f],f,this)){return true}}return false}}if(!Array.prototype.filter){Array.prototype.filter=function(j,h){var f=[],k;for(var g=0,e=this.length>>>0;g<e;g++){if(g in this){k=this[g];if(j.call(h,k,g,this)){f.push(k)}}}return f}}if(!Array.prototype.reduce){Array.prototype.reduce=function(g){var e=this.length>>>0,f=0,h;if(arguments.length>1){h=arguments[1]}else{do{if(f in this){h=this[f++];break}if(++f>=e){throw new TypeError()}}while(true)}for(;f<e;f++){if(f in this){h=g.call(null,h,this[f],f,this)}}return h}}function b(k,j){var g=d.call(arguments,2),f=[];for(var h=0,e=k.length;h<e;h++){f[h]=g.length?k[h][j].apply(k[h],g):k[h][j].call(k[h])}return f}function a(h,g){if(!h||h.length===0){return undefined}var f=h.length-1,e=g?h[f][g]:h[f];if(g){while(f--){if(h[f][g]>=e){e=h[f][g]}}}else{while(f--){if(h[f]>=e){e=h[f]}}}return e}function c(h,g){if(!h||h.length===0){return undefined}var f=h.length-1,e=g?h[f][g]:h[f];if(g){while(f--){if(h[f][g]<e){e=h[f][g]}}}else{while(f--){if(h[f]<e){e=h[f]}}}return e}fabric.util.array={invoke:b,min:c,max:a}})();(function(){function b(c,e){for(var d in e){c[d]=e[d]}return c}function a(c){return b({},c)}fabric.util.object={extend:b,clone:a}})();(function(){if(!String.prototype.trim){String.prototype.trim=function(){return this.replace(/^[\s\xA0]+/,"").replace(/[\s\xA0]+$/,"")}}function b(d){return d.replace(/-+(.)?/g,function(e,f){return f?f.toUpperCase():""})}function c(d){return d.charAt(0).toUpperCase()+d.slice(1).toLowerCase()}function a(d){return d.replace(/&/g,"&amp;").replace(/"/g,"&quot;").replace(/'/g,"&apos;").replace(/</g,"&lt;").replace(/>/g,"&gt;")}fabric.util.string={camelize:b,capitalize:c,escapeXml:a}}());(function(){var c=Array.prototype.slice,a=Function.prototype.apply,b=function(){};if(!Function.prototype.bind){Function.prototype.bind=function(d){var g=this,e=c.call(arguments,1),f;if(e.length){f=function(){return a.call(g,this instanceof b?this:d,e.concat(c.call(arguments)))}}else{f=function(){return a.call(g,this instanceof b?this:d,arguments)}}b.prototype=this.prototype;f.prototype=new b();return f}}})();(function(){var g=Array.prototype.slice,f=function(){};var d=(function(){for(var h in {toString:1}){if(h==="toString"){return false}}return true})();var c=function(h,k,i){for(var j in k){if(j in h.prototype&&typeof h.prototype[j]==="function"&&(k[j]+"").indexOf("callSuper")>-1){h.prototype[j]=(function(l){return function(){var n=this.constructor.superclass;this.constructor.superclass=i;var m=k[l].apply(this,arguments);this.constructor.superclass=n;if(l!=="initialize"){return m}}})(j)}else{h.prototype[j]=k[j]}if(d){if(k.toString!==Object.prototype.toString){h.prototype.toString=k.toString}if(k.valueOf!==Object.prototype.valueOf){h.prototype.valueOf=k.valueOf}}}};function b(){}function a(h){var i=this.constructor.superclass.prototype[h];return(arguments.length>1)?i.apply(this,g.call(arguments,1)):i.call(this)}function e(){var l=null,k=g.call(arguments,0);if(typeof k[0]==="function"){l=k.shift()}function h(){this.initialize.apply(this,arguments)}h.superclass=l;h.subclasses=[];if(l){b.prototype=l.prototype;h.prototype=new b();l.subclasses.push(h)}for(var j=0,m=k.length;j<m;j++){c(h,k[j],l)}if(!h.prototype.initialize){h.prototype.initialize=f}h.prototype.constructor=h;h.prototype.callSuper=a;return h}fabric.util.createClass=e})();(function(){function g(r){var v=Array.prototype.slice.call(arguments,1),u,s,q=v.length;for(s=0;s<q;s++){u=typeof r[v[s]];if(!(/^(?:function|object|unknown)$/).test(u)){return false}}return true}var d=(function(){var q=0;return function(r){return r.__uniqueID||(r.__uniqueID="uniqueID__"+q++)}})();var e,c;(function(){var q={};e=function(r){return q[r]};c=function(s,r){q[s]=r}})();function h(q,r){return{handler:r,wrappedHandler:k(q,r)}}function k(q,r){return function(s){r.call(e(q),s||fabric.window.event)}}function i(r,q){return function(v){if(f[r]&&f[r][q]){var t=f[r][q];for(var u=0,s=t.length;u<s;u++){t[u].call(this,v||fabric.window.event)}}}}var n=(g(fabric.document.documentElement,"addEventListener","removeEventListener")&&g(fabric.window,"addEventListener","removeEventListener")),l=(g(fabric.document.documentElement,"attachEvent","detachEvent")&&g(fabric.window,"attachEvent","detachEvent")),m={},f={},b,j;if(n){b=function(r,q,s){r.addEventListener(q,s,false)};j=function(r,q,s){r.removeEventListener(q,s,false)}}else{if(l){b=function(s,q,t){var r=d(s);c(r,s);if(!m[r]){m[r]={}}if(!m[r][q]){m[r][q]=[]}var u=h(r,t);m[r][q].push(u);s.attachEvent("on"+q,u.wrappedHandler)};j=function(u,r,v){var t=d(u),w;if(m[t]&&m[t][r]){for(var s=0,q=m[t][r].length;s<q;s++){w=m[t][r][s];if(w&&w.handler===v){u.detachEvent("on"+r,w.wrappedHandler);m[t][r][s]=null}}}}}else{b=function(s,q,t){var r=d(s);if(!f[r]){f[r]={}}if(!f[r][q]){f[r][q]=[];var u=s["on"+q];if(u){f[r][q].push(u)}s["on"+q]=i(r,q)}f[r][q].push(t)};j=function(v,s,w){var u=d(v);if(f[u]&&f[u][s]){var r=f[u][s];for(var t=0,q=r.length;t<q;t++){if(r[t]===w){r.splice(t,1)}}}}}}fabric.util.addListener=b;fabric.util.removeListener=j;function p(r,x){r||(r=fabric.window.event);var w=r.target||(typeof r.srcElement!=="unknown"?r.srcElement:null),y=fabric.document.body||{scrollLeft:0,scrollTop:0},t=fabric.document.documentElement,v=w,u=0,s=0,q;while(w&&w.parentNode&&!q){w=w.parentNode;if(w!==fabric.document&&fabric.util.getElementPosition(w)==="fixed"){q=w}if(w!==fabric.document&&v!==x&&fabric.util.getElementPosition(w)==="absolute"){u=0;s=0}else{if(w===fabric.document&&v!==x){u=y.scrollLeft||t.scrollLeft||0;s=y.scrollTop||t.scrollTop||0}else{u+=w.scrollLeft||0;s+=w.scrollTop||0}}}return{x:a(r)+u,y:o(r)+s}}var a=function(q){return(typeof q.clientX!=="unknown"?q.clientX:0)};var o=function(q){return(typeof q.clientY!=="unknown"?q.clientY:0)};if(fabric.isTouchSupported){a=function(q){if(q.type!=="touchend"){return(q.touches&&q.touches[0]?(q.touches[0].pageX-(q.touches[0].pageX-q.touches[0].clientX))||q.clientX:q.clientX)}return(q.changedTouches&&q.changedTouches[0]?(q.changedTouches[0].pageX-(q.changedTouches[0].pageX-q.changedTouches[0].clientX))||q.clientX:q.clientX)};o=function(q){if(q.type!=="touchend"){return(q.touches&&q.touches[0]?(q.touches[0].pageY-(q.touches[0].pageY-q.touches[0].clientY))||q.clientY:q.clientY)}return(q.changedTouches&&q.changedTouches[0]?(q.changedTouches[0].pageY-(q.changedTouches[0].pageY-q.changedTouches[0].clientY))||q.clientY:q.clientY)}}fabric.util.getPointer=p;fabric.util.object.extend(fabric.util,fabric.Observable)})();(function(){function d(g,i){var k=g.style;if(!k){return g}if(typeof i==="string"){g.style.cssText+=";"+i;return i.indexOf("opacity")>-1?b(g,i.match(/opacity:\s*(\d?\.?\d*)/)[1]):g}for(var j in i){if(j==="opacity"){b(g,i[j])}else{var h=(j==="float"||j==="cssFloat")?(typeof k.styleFloat==="undefined"?"cssFloat":"styleFloat"):j;k[h]=i[j]}}return g}var f=fabric.document.createElement("div"),e=typeof f.style.opacity==="string",a=typeof f.style.filter==="string",c=/alpha\s*\(\s*opacity\s*=\s*([^\)]+)\)/,b=function(g){return g};if(e){b=function(g,h){g.style.opacity=h;return g}}else{if(a){b=function(g,h){var i=g.style;if(g.currentStyle&&!g.currentStyle.hasLayout){i.zoom=1}if(c.test(i.filter)){h=h>=0.9999?"":("alpha(opacity="+(h*100)+")");i.filter=i.filter.replace(c,h)}else{i.filter+=" alpha(opacity="+(h*100)+")"}return g}}}fabric.util.setStyle=d})();(function(){var i=Array.prototype.slice;function h(k){return typeof k==="string"?fabric.document.getElementById(k):k}var c=function(k){return i.call(k,0)};var j;try{j=c(fabric.document.childNodes) instanceof Array}catch(b){}if(!j){c=function(l){var k=new Array(l.length),m=l.length;while(m--){k[m]=l[m]}return k}}function d(l,k){var m=fabric.document.createElement(l);for(var n in k){if(n==="class"){m.className=k[n]}else{if(n==="for"){m.htmlFor=k[n]}else{m.setAttribute(n,k[n])}}}return m}function g(k,l){if((" "+k.className+" ").indexOf(" "+l+" ")===-1){k.className+=(k.className?" ":"")+l}}function f(l,m,k){if(typeof m==="string"){m=d(m,k)}if(l.parentNode){l.parentNode.replaceChild(m,l)}m.appendChild(l);return m}function e(l){var k=0,m=0;do{k+=l.offsetTop||0;m+=l.offsetLeft||0;l=l.offsetParent}while(l);return({left:m,top:k})}var a;if(fabric.document.defaultView&&fabric.document.defaultView.getComputedStyle){a=function(k){return fabric.document.defaultView.getComputedStyle(k,null).position}}else{a=function(k){var l=k.style.position;if(!l&&k.currentStyle){l=k.currentStyle.position}return l}}(function(){var l=fabric.document.documentElement.style;var m="userSelect" in l?"userSelect":"MozUserSelect" in l?"MozUserSelect":"WebkitUserSelect" in l?"WebkitUserSelect":"KhtmlUserSelect" in l?"KhtmlUserSelect":"";function n(o){if(typeof o.onselectstart!=="undefined"){o.onselectstart=fabric.util.falseFunction}if(m){o.style[m]="none"}else{if(typeof o.unselectable==="string"){o.unselectable="on"}}return o}function k(o){if(typeof o.onselectstart!=="undefined"){o.onselectstart=null}if(m){o.style[m]=""}else{if(typeof o.unselectable==="string"){o.unselectable=""}}return o}fabric.util.makeElementUnselectable=n;fabric.util.makeElementSelectable=k})();(function(){function k(l,p){var n=fabric.document.getElementsByTagName("head")[0],m=fabric.document.createElement("script"),o=true;m.type="text/javascript";m.setAttribute("runat","server");m.onload=m.onreadystatechange=function(q){if(o){if(typeof this.readyState==="string"&&this.readyState!=="loaded"&&this.readyState!=="complete"){return}o=false;p(q||fabric.window.event);m=m.onload=m.onreadystatechange=null}};m.src=l;n.appendChild(m)}fabric.util.getScript=k})();fabric.util.getById=h;fabric.util.toArray=c;fabric.util.makeElement=d;fabric.util.addClass=g;fabric.util.wrapElement=f;fabric.util.getElementOffset=e;fabric.util.getElementPosition=a})();(function(){function d(e,f){return e+(/\?/.test(e)?"&":"?")+f}var c=(function(){var h=[function(){return new ActiveXObject("Microsoft.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP")},function(){return new ActiveXObject("Msxml2.XMLHTTP.3.0")},function(){return new XMLHttpRequest()}];for(var e=h.length;e--;){try{var g=h[e]();if(g){return h[e]}}catch(f){}}})();function a(){}function b(g,f){f||(f={});var j=f.method?f.method.toUpperCase():"GET",h=f.onComplete||function(){},i=c(),e;i.onreadystatechange=function(){if(i.readyState===4){h(i);i.onreadystatechange=a}};if(j==="GET"){e=null;if(typeof f.parameters==="string"){g=d(g,f.parameters)}}i.open(j,g,true);if(j==="POST"||j==="PUT"){i.setRequestHeader("Content-Type","application/x-www-form-urlencoded")}i.send(e);return i}fabric.util.request=b})();(function(){function d(f){var e=f.getAttribute("style"),h=f.getAttribute("offset"),g,l;h=parseFloat(h)/(/%$/.test(h)?100:1);if(e){var k=e.split(/\s*;\s*/);if(k[k.length-1]===""){k.pop()}for(var j=k.length;j--;){var m=k[j].split(/\s*:\s*/),o=m[0].trim(),n=m[1].trim();if(o==="stop-color"){g=n}else{if(o==="stop-opacity"){l=n}}}}if(!g){g=f.getAttribute("stop-color")}if(!l){l=f.getAttribute("stop-opacity")}g=new fabric.Color(g).toRgb();return{offset:h,color:g,opacity:l}}fabric.Gradient=fabric.util.createClass({initialize:function(e){e||(e={});var f={};this.id=fabric.Object.__uid++;this.type=e.type||"linear";f={x1:e.coords.x1||0,y1:e.coords.y1||0,x2:e.coords.x2||0,y2:e.coords.y2||0};if(this.type==="radial"){f.r1=e.coords.r1||0;f.r2=e.coords.r2||0}this.coords=f;this.gradientUnits=e.gradientUnits||"objectBoundingBox";this.colorStops=e.colorStops.slice()},addColorStop:function(f){for(var e in f){var g=new fabric.Color(f[e]);this.colorStops.push({offset:e,color:g.toRgb(),opacity:g.getAlpha()})}return this},toObject:function(){return{type:this.type,coords:this.coords,gradientUnits:this.gradientUnits,colorStops:this.colorStops}},toLive:function(e){var j;if(!this.type){return}if(this.type==="linear"){j=e.createLinearGradient(this.coords.x1,this.coords.y1,this.coords.x2||e.canvas.width,this.coords.y2)}else{if(this.type==="radial"){j=e.createRadialGradient(this.coords.x1,this.coords.y1,this.coords.r1,this.coords.x2,this.coords.y2,this.coords.r2)}}for(var h=0;h<this.colorStops.length;h++){var f=this.colorStops[h].color,g=this.colorStops[h].opacity,k=this.colorStops[h].offset;if(g){f=new fabric.Color(f).setAlpha(g).toRgba()}j.addColorStop(parseFloat(k),f)}return j},toSVG:function(g,f){var j=fabric.util.object.clone(this.coords),e;this.colorStops.sort(function(k,i){return k.offset-i.offset});if(f&&this.gradientUnits==="userSpaceOnUse"){j.x1+=g.width/2;j.y1+=g.height/2;j.x2+=g.width/2;j.y2+=g.height/2}else{if(this.gradientUnits==="objectBoundingBox"){c(g,j)}}if(this.type==="linear"){e=["<linearGradient ",'id="SVGID_',this.id,'" gradientUnits="',this.gradientUnits,'" x1="',j.x1,'" y1="',j.y1,'" x2="',j.x2,'" y2="',j.y2,'">']}else{if(this.type==="radial"){e=["<radialGradient ",'id="SVGID_',this.id,'" gradientUnits="',this.gradientUnits,'" cx="',j.x2,'" cy="',j.y2,'" r="',j.r2,'" fx="',j.x1,'" fy="',j.y1,'">']}}for(var h=0;h<this.colorStops.length;h++){e.push("<stop ",'offset="',(this.colorStops[h].offset*100)+"%",'" style="stop-color:',this.colorStops[h].color,(this.colorStops[h].opacity?";stop-opacity: "+this.colorStops[h].opacity:";"),'"/>')}e.push((this.type==="linear"?"</linearGradient>":"</radialGradient>"));return e.join("")}});fabric.util.object.extend(fabric.Gradient,{fromElement:function(k,e){var m=k.getElementsByTagName("stop"),j=(k.nodeName==="linearGradient"?"linear":"radial"),g=k.getAttribute("gradientUnits")||"objectBoundingBox",f=[],l={};if(j==="linear"){l={x1:k.getAttribute("x1")||0,y1:k.getAttribute("y1")||0,x2:k.getAttribute("x2")||"100%",y2:k.getAttribute("y2")||0}}else{if(j==="radial"){l={x1:k.getAttribute("fx")||k.getAttribute("cx")||"50%",y1:k.getAttribute("fy")||k.getAttribute("cy")||"50%",r1:0,x2:k.getAttribute("cx")||"50%",y2:k.getAttribute("cy")||"50%",r2:k.getAttribute("r")||"50%"}}}for(var h=m.length;h--;){f.push(d(m[h]))}a(e,l);return new fabric.Gradient({type:j,coords:l,gradientUnits:g,colorStops:f})},forObject:function(f,e){e||(e={});a(f,e);return new fabric.Gradient(e)}});function a(g,f){for(var h in f){if(typeof f[h]==="string"&&/^\d+%$/.test(f[h])){var e=parseFloat(f[h],10);if(h==="x1"||h==="x2"||h==="r2"){f[h]=fabric.util.toFixed(g.width*e/100,2)}else{if(h==="y1"||h==="y2"){f[h]=fabric.util.toFixed(g.height*e/100,2)}}}if(h==="x1"||h==="x2"){f[h]-=fabric.util.toFixed(g.width/2,2)}else{if(h==="y1"||h==="y2"){f[h]-=fabric.util.toFixed(g.height/2,2)}}}}function c(f,e){for(var g in e){if(g==="x1"||g==="x2"){e[g]+=fabric.util.toFixed(f.width/2,2)}else{if(g==="y1"||g==="y2"){e[g]+=fabric.util.toFixed(f.height/2,2)}}if(g==="x1"||g==="x2"||g==="r2"){e[g]=fabric.util.toFixed(e[g]/f.width*100,2)+"%"}else{if(g==="y1"||g==="y2"){e[g]=fabric.util.toFixed(e[g]/f.height*100,2)+"%"}}}}function b(k){var g=k.getElementsByTagName("linearGradient"),e=k.getElementsByTagName("radialGradient"),h,f,j={};f=g.length;for(;f--;){h=g[f];j[h.getAttribute("id")]=h}f=e.length;for(;f--;){h=e[f];j[h.getAttribute("id")]=h}return j}fabric.getGradientDefs=b})();fabric.Pattern=fabric.util.createClass({repeat:"repeat",initialize:function(a){a||(a={});if(a.source){this.source=typeof a.source==="string"?new Function(a.source):a.source}if(a.repeat){this.repeat=a.repeat}},toObject:function(){var a;if(typeof this.source==="function"){a=String(this.source).match(/function\s+\w*\s*\(.*\)\s+\{([\s\S]*)\}/)[1]}else{if(typeof this.source.src==="string"){a=this.source.src}}return{source:a,repeat:this.repeat}},toLive:function(a){var b=typeof this.source==="function"?this.source():this.source;return a.createPattern(b,this.repeat)}});fabric.Shadow=fabric.util.createClass({color:"rgb(0,0,0)",blur:0,offsetX:0,offsetY:0,affectStroke:false,initialize:function(a){for(var b in a){this[b]=a[b]}},toObject:function(){return{color:this.color,blur:this.blur,offsetX:this.offsetX,offsetY:this.offsetY}},toSVG:function(){}});(function(b){var c=b.fabric||(b.fabric={});if(c.Point){c.warn("fabric.Point is already defined");return}c.Point=a;function a(d,e){if(arguments.length>0){this.init(d,e)}}a.prototype={constructor:a,init:function(d,e){this.x=d;this.y=e},add:function(d){return new a(this.x+d.x,this.y+d.y)},addEquals:function(d){this.x+=d.x;this.y+=d.y;return this},scalarAdd:function(d){return new a(this.x+d,this.y+d)},scalarAddEquals:function(d){this.x+=d;this.y+=d;return this},subtract:function(d){return new a(this.x-d.x,this.y-d.y)},subtractEquals:function(d){this.x-=d.x;this.y-=d.y;return this},scalarSubtract:function(d){return new a(this.x-d,this.y-d)},scalarSubtractEquals:function(d){this.x-=d;this.y-=d;return this},multiply:function(d){return new a(this.x*d,this.y*d)},multiplyEquals:function(d){this.x*=d;this.y*=d;return this},divide:function(d){return new a(this.x/d,this.y/d)},divideEquals:function(d){this.x/=d;this.y/=d;return this},eq:function(d){return(this.x===d.x&&this.y===d.y)},lt:function(d){return(this.x<d.x&&this.y<d.y)},lte:function(d){return(this.x<=d.x&&this.y<=d.y)},gt:function(d){return(this.x>d.x&&this.y>d.y)},gte:function(d){return(this.x>=d.x&&this.y>=d.y)},lerp:function(e,d){return new a(this.x+(e.x-this.x)*d,this.y+(e.y-this.y)*d)},distanceFrom:function(f){var e=this.x-f.x,d=this.y-f.y;return Math.sqrt(e*e+d*d)},midPointFrom:function(d){return new a(this.x+(d.x-this.x)/2,this.y+(d.y-this.y)/2)},min:function(d){return new a(Math.min(this.x,d.x),Math.min(this.y,d.y))},max:function(d){return new a(Math.max(this.x,d.x),Math.max(this.y,d.y))},toString:function(){return this.x+","+this.y},setXY:function(d,e){this.x=d;this.y=e},setFromPoint:function(d){this.x=d.x;this.y=d.y},swap:function(e){var d=this.x,f=this.y;this.x=e.x;this.y=e.y;e.x=d;e.y=f}}})(typeof exports!=="undefined"?exports:this);(function(a){var b=a.fabric||(a.fabric={});if(b.Intersection){b.warn("fabric.Intersection is already defined");return}function c(d){if(arguments.length>0){this.init(d)}}b.Intersection=c;b.Intersection.prototype={init:function(d){this.status=d;this.points=[]},appendPoint:function(d){this.points.push(d)},appendPoints:function(d){this.points=this.points.concat(d)}};b.Intersection.intersectLineLine=function(h,f,l,k){var m,i=(k.x-l.x)*(h.y-l.y)-(k.y-l.y)*(h.x-l.x),j=(f.x-h.x)*(h.y-l.y)-(f.y-h.y)*(h.x-l.x),g=(k.y-l.y)*(f.x-h.x)-(k.x-l.x)*(f.y-h.y);if(g!==0){var e=i/g,d=j/g;if(0<=e&&e<=1&&0<=d&&d<=1){m=new c("Intersection");m.points.push(new b.Point(h.x+e*(f.x-h.x),h.y+e*(f.y-h.y)))}else{m=new c("No Intersection")}}else{if(i===0||j===0){m=new c("Coincident")}else{m=new c("Parallel")}}return m};b.Intersection.intersectLinePolygon=function(e,d,l){var m=new c("No Intersection"),f=l.length;for(var h=0;h<f;h++){var k=l[h],j=l[(h+1)%f],g=c.intersectLineLine(e,d,k,j);m.appendPoints(g.points)}if(m.points.length>0){m.status="Intersection"}return m};b.Intersection.intersectPolygonPolygon=function(j,h){var f=new c("No Intersection"),l=j.length;for(var k=0;k<l;k++){var g=j[k],e=j[(k+1)%l],d=c.intersectLinePolygon(g,e,h);f.appendPoints(d.points)}if(f.points.length>0){f.status="Intersection"}return f};b.Intersection.intersectPolygonRectangle=function(n,e,d){var g=e.min(d),m=e.max(d),f=new b.Point(m.x,g.y),l=new b.Point(g.x,m.y),k=c.intersectLinePolygon(g,f,n),j=c.intersectLinePolygon(f,m,n),i=c.intersectLinePolygon(m,l,n),h=c.intersectLinePolygon(l,g,n),o=new c("No Intersection");o.appendPoints(k.points);o.appendPoints(j.points);o.appendPoints(i.points);o.appendPoints(h.points);if(o.points.length>0){o.status="Intersection"}return o}})(typeof exports!=="undefined"?exports:this);(function(a){var b=a.fabric||(a.fabric={});if(b.Color){b.warn("fabric.Color is already defined.");return}function c(d){if(!d){this.setSource([0,0,0,1])}else{this._tryParsingColor(d)}}b.Color=c;b.Color.prototype={_tryParsingColor:function(d){var e;if(d in c.colorNameMap){d=c.colorNameMap[d]}e=c.sourceFromHex(d);if(!e){e=c.sourceFromRgb(d)}if(e){this.setSource(e)}},getSource:function(){return this._source},setSource:function(d){this._source=d},toRgb:function(){var d=this.getSource();return"rgb("+d[0]+","+d[1]+","+d[2]+")"},toRgba:function(){var d=this.getSource();return"rgba("+d[0]+","+d[1]+","+d[2]+","+d[3]+")"},toHex:function(){var h=this.getSource();var f=h[0].toString(16);f=(f.length===1)?("0"+f):f;var e=h[1].toString(16);e=(e.length===1)?("0"+e):e;var d=h[2].toString(16);d=(d.length===1)?("0"+d):d;return f.toUpperCase()+e.toUpperCase()+d.toUpperCase()},getAlpha:function(){return this.getSource()[3]},setAlpha:function(e){var d=this.getSource();d[3]=e;this.setSource(d);return this},toGrayscale:function(){var f=this.getSource(),e=parseInt((f[0]*0.3+f[1]*0.59+f[2]*0.11).toFixed(0),10),d=f[3];this.setSource([e,e,e,d]);return this},toBlackWhite:function(d){var g=this.getSource(),f=(g[0]*0.3+g[1]*0.59+g[2]*0.11).toFixed(0),e=g[3];d=d||127;f=(Number(f)<Number(d))?0:255;this.setSource([f,f,f,e]);return this},overlayWith:function(k){if(!(k instanceof c)){k=new c(k)}var d=[],j=this.getAlpha(),g=0.5,h=this.getSource(),e=k.getSource();for(var f=0;f<3;f++){d.push(Math.round((h[f]*(1-g))+(e[f]*g)))}d[3]=j;this.setSource(d);return this}};b.Color.reRGBa=/^rgba?\((\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})(?:\s*,\s*(\d+(?:\.\d+)?))?\)$/;b.Color.reHex=/^#?([0-9a-f]{6}|[0-9a-f]{3})$/i;b.Color.colorNameMap={aqua:"#00FFFF",black:"#000000",blue:"#0000FF",fuchsia:"#FF00FF",gray:"#808080",green:"#008000",lime:"#00FF00",maroon:"#800000",navy:"#000080",olive:"#808000",purple:"#800080",red:"#FF0000",silver:"#C0C0C0",teal:"#008080",white:"#FFFFFF",yellow:"#FFFF00"};b.Color.fromRgb=function(d){return c.fromSource(c.sourceFromRgb(d))};b.Color.sourceFromRgb=function(d){var e=d.match(c.reRGBa);if(e){return[parseInt(e[1],10),parseInt(e[2],10),parseInt(e[3],10),e[4]?parseFloat(e[4]):1]}};b.Color.fromRgba=c.fromRgb;b.Color.fromHex=function(d){return c.fromSource(c.sourceFromHex(d))};b.Color.sourceFromHex=function(f){if(f.match(c.reHex)){var j=f.slice(f.indexOf("#")+1),e=(j.length===3),i=e?(j.charAt(0)+j.charAt(0)):j.substring(0,2),h=e?(j.charAt(1)+j.charAt(1)):j.substring(2,4),d=e?(j.charAt(2)+j.charAt(2)):j.substring(4,6);return[parseInt(i,16),parseInt(h,16),parseInt(d,16),1]}};b.Color.fromSource=function(d){var e=new c();e.setSource(d);return e}})(typeof exports!=="undefined"?exports:this);(function(){if(fabric.StaticCanvas){fabric.warn("fabric.StaticCanvas is already defined.");return}var e=fabric.util.object.extend,c=fabric.util.getElementOffset,d=fabric.util.removeFromArray,b=fabric.util.removeListener,a=new Error("Could not initialize `canvas` element");fabric.StaticCanvas=function(g,f){f||(f={});this._initStatic(g,f);fabric.StaticCanvas.activeInstance=this};e(fabric.StaticCanvas.prototype,fabric.Observable);e(fabric.StaticCanvas.prototype,fabric.Collection);e(fabric.StaticCanvas.prototype,{backgroundColor:"",backgroundImage:"",backgroundImageOpacity:1,backgroundImageStretch:true,overlayImage:"",overlayImageLeft:0,overlayImageTop:0,includeDefaultValues:true,stateful:true,renderOnAddition:true,clipTo:null,controlsAboveOverlay:false,onBeforeScaleRotate:function(){},_initStatic:function(g,f){this._objects=[];this._createLowerCanvas(g);this._initOptions(f);if(f.overlayImage){this.setOverlayImage(f.overlayImage,this.renderAll.bind(this))}if(f.backgroundImage){this.setBackgroundImage(f.backgroundImage,this.renderAll.bind(this))}if(f.backgroundColor){this.setBackgroundColor(f.backgroundColor,this.renderAll.bind(this))}this.calcOffset()},calcOffset:function(){this._offset=c(this.lowerCanvasEl);return this},setOverlayImage:function(g,h,f){fabric.util.loadImage(g,function(i){this.overlayImage=i;if(f&&("overlayImageLeft" in f)){this.overlayImageLeft=f.overlayImageLeft}if(f&&("overlayImageTop" in f)){this.overlayImageTop=f.overlayImageTop}h&&h()},this);return this},setBackgroundImage:function(g,h,f){fabric.util.loadImage(g,function(i){this.backgroundImage=i;if(f&&("backgroundImageOpacity" in f)){this.backgroundImageOpacity=f.backgroundImageOpacity}if(f&&("backgroundImageStretch" in f)){this.backgroundImageStretch=f.backgroundImageStretch}h&&h()},this);return this},setBackgroundColor:function(f,h){if(f.source){var g=this;fabric.util.loadImage(f.source,function(i){g.backgroundColor=new fabric.Pattern({source:i,repeat:f.repeat});h&&h()})}else{this.backgroundColor=f;h&&h()}return this},_createCanvasElement:function(){var f=fabric.document.createElement("canvas");if(!f.style){f.style={}}if(!f){throw a}this._initCanvasElement(f);return f},_initCanvasElement:function(f){fabric.util.createCanvasElement(f);if(typeof f.getContext==="undefined"){throw a}},_initOptions:function(f){for(var g in f){this[g]=f[g]}this.width=parseInt(this.lowerCanvasEl.width,10)||0;this.height=parseInt(this.lowerCanvasEl.height,10)||0;if(!this.lowerCanvasEl.style){return}this.lowerCanvasEl.style.width=this.width+"px";this.lowerCanvasEl.style.height=this.height+"px"},_createLowerCanvas:function(f){this.lowerCanvasEl=fabric.util.getById(f)||this._createCanvasElement();this._initCanvasElement(this.lowerCanvasEl);fabric.util.addClass(this.lowerCanvasEl,"lower-canvas");if(this.interactive){this._applyCanvasStyle(this.lowerCanvasEl)}this.contextContainer=this.lowerCanvasEl.getContext("2d")},getWidth:function(){return this.width},getHeight:function(){return this.height},setWidth:function(f){return this._setDimension("width",f)},setHeight:function(f){return this._setDimension("height",f)},setDimensions:function(f){for(var g in f){this._setDimension(g,f[g])}return this},_setDimension:function(g,f){this.lowerCanvasEl[g]=f;this.lowerCanvasEl.style[g]=f+"px";if(this.upperCanvasEl){this.upperCanvasEl[g]=f;this.upperCanvasEl.style[g]=f+"px"}if(this.cacheCanvasEl){this.cacheCanvasEl[g]=f}if(this.wrapperEl){this.wrapperEl.style[g]=f+"px"}this[g]=f;this.calcOffset();this.renderAll();return this},getElement:function(){return this.lowerCanvasEl},getActiveObject:function(){return null},getActiveGroup:function(){return null},_draw:function(g,h){if(!h){return}if(this.controlsAboveOverlay){var f=h.hasBorders,i=h.hasControls;h.hasBorders=h.hasControls=false;h.render(g);h.hasBorders=f;h.hasControls=i}else{h.render(g)}},_onObjectAdded:function(f){this.stateful&&f.setupState();f.setCoords();f.canvas=this;this.fire("object:added",{target:f});f.fire("added")},_onObjectRemoved:function(f){this.fire("object:removed",{target:f});f.fire("removed")},getObjects:function(){return this._objects},clearContext:function(f){f.clearRect(0,0,this.width,this.height);return this},getContext:function(){return this.contextContainer},clear:function(){this._objects.length=0;if(this.discardActiveGroup){this.discardActiveGroup()}if(this.discardActiveObject){this.discardActiveObject()}this.clearContext(this.contextContainer);if(this.contextTop){this.clearContext(this.contextTop)}this.fire("canvas:cleared");this.renderAll();return this},renderAll:function(f){var g=this[(f===true&&this.interactive)?"contextTop":"contextContainer"];if(this.contextTop&&this.selection){this.clearContext(this.contextTop)}if(!f){this.clearContext(g)}this.fire("before:render");if(this.clipTo){fabric.util.clipContext(this,g)}if(this.backgroundColor){g.fillStyle=this.backgroundColor.toLive?this.backgroundColor.toLive(g):this.backgroundColor;g.fillRect(0,0,this.width,this.height)}if(typeof this.backgroundImage==="object"){this._drawBackroundImage(g)}var j=this.getActiveGroup();for(var h=0,k=this._objects.length;h<k;++h){if(!j||(j&&this._objects[h]&&!j.contains(this._objects[h]))){this._draw(g,this._objects[h])}}if(j){var l=[];this.forEachObject(function(i){if(j.contains(i)){l.push(i)}});j._set("objects",l);this._draw(g,j)}if(this.clipTo){g.restore()}if(this.overlayImage){g.drawImage(this.overlayImage,this.overlayImageLeft,this.overlayImageTop)}if(this.controlsAboveOverlay){this.drawControls(g)}this.fire("after:render");return this},_drawBackroundImage:function(f){f.save();f.globalAlpha=this.backgroundImageOpacity;if(this.backgroundImageStretch){f.drawImage(this.backgroundImage,0,0,this.width,this.height)}else{f.drawImage(this.backgroundImage,0,0)}f.restore()},renderTop:function(){var f=this.contextTop||this.contextContainer;this.clearContext(f);if(this.selection&&this._groupSelector){this._drawSelection()}var g=this.getActiveGroup();if(g){g.render(f)}if(this.overlayImage){f.drawImage(this.overlayImage,this.overlayImageLeft,this.overlayImageTop)}this.fire("after:render");return this},drawControls:function(g){var j=this.getActiveGroup();if(j){g.save();fabric.Group.prototype.transform.call(j,g);j.drawBorders(g).drawControls(g);g.restore()}else{for(var h=0,f=this._objects.length;h<f;++h){if(!this._objects[h]||!this._objects[h].active){continue}g.save();fabric.Object.prototype.transform.call(this._objects[h],g);this._objects[h].drawBorders(g).drawControls(g);g.restore();this.lastRenderedObjectWithControlsAboveOverlay=this._objects[h]}}},toDataURL:function(f){f||(f={});var g=f.format||"png",i=f.quality||1,h=f.multiplier||1;if(h!==1){return this.__toDataURLWithMultiplier(g,i,h)}else{return this.__toDataURL(g,i)}},__toDataURL:function(h,i){this.renderAll(true);var f=this.upperCanvasEl||this.lowerCanvasEl;var g=(fabric.StaticCanvas.supports("toDataURLWithQuality"))?f.toDataURL("image/"+h,i):f.toDataURL("image/"+h);this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return g},__toDataURLWithMultiplier:function(k,l,o){var m=this.getWidth(),p=this.getHeight(),i=m*o,j=p*o,f=this.getActiveObject(),g=this.getActiveGroup(),n=this.contextTop||this.contextContainer;this.setWidth(i).setHeight(j);n.scale(o,o);if(g){this._tempRemoveBordersControlsFromGroup(g)}else{if(f&&this.deactivateAll){this.deactivateAll()}}this.width=m;this.height=p;this.renderAll(true);var h=this.__toDataURL(k,l);n.scale(1/o,1/o);this.setWidth(m).setHeight(p);if(g){this._restoreBordersControlsOnGroup(g)}else{if(f&&this.setActiveObject){this.setActiveObject(f)}}this.contextTop&&this.clearContext(this.contextTop);this.renderAll();return h},toDataURLWithMultiplier:function(f,h,g){return this.toDataURL({format:f,multiplier:h,quality:g})},_tempRemoveBordersControlsFromGroup:function(f){f.origHasControls=f.hasControls;f.origBorderColor=f.borderColor;f.hasControls=true;f.borderColor="rgba(0,0,0,0)";f.forEachObject(function(g){g.origBorderColor=g.borderColor;g.borderColor="rgba(0,0,0,0)"})},_restoreBordersControlsOnGroup:function(f){f.hideControls=f.origHideControls;f.borderColor=f.origBorderColor;f.forEachObject(function(g){g.borderColor=g.origBorderColor;delete g.origBorderColor})},getCenter:function(){return{top:this.getHeight()/2,left:this.getWidth()/2}},centerObjectH:function(f){f.set("left",this.getCenter().left);this.renderAll();return this},centerObjectV:function(f){f.set("top",this.getCenter().top);this.renderAll();return this},centerObject:function(f){return this.centerObjectH(f).centerObjectV(f)},toDatalessJSON:function(f){return this.toDatalessObject(f)},toObject:function(f){return this._toObjectMethod("toObject",f)},toDatalessObject:function(f){return this._toObjectMethod("toDatalessObject",f)},_toObjectMethod:function(f,h){var g={objects:this._objects.map(function(i){var j;if(!this.includeDefaultValues){j=i.includeDefaultValues;i.includeDefaultValues=false}var k=i[f](h);if(!this.includeDefaultValues){i.includeDefaultValues=j}return k},this),background:(this.backgroundColor&&this.backgroundColor.toObject)?this.backgroundColor.toObject():this.backgroundColor};if(this.backgroundImage){g.backgroundImage=this.backgroundImage.src;g.backgroundImageOpacity=this.backgroundImageOpacity;g.backgroundImageStretch=this.backgroundImageStretch}if(this.overlayImage){g.overlayImage=this.overlayImage.src;g.overlayImageLeft=this.overlayImageLeft;g.overlayImageTop=this.overlayImageTop}fabric.util.populateWithProperties(this,g,h);return g},toSVG:function(h){h||(h={});var g=[];if(!h.suppressPreamble){g.push('<?xml version="1.0" standalone="no" ?>','<!DOCTYPE svg PUBLIC "-//W3C//DTD SVG 1.1//EN" ','"http://www.w3.org/Graphics/SVG/1.1/DTD/svg11.dtd">')}g.push("<svg ",'xmlns="http://www.w3.org/2000/svg" ','xmlns:xlink="http://www.w3.org/1999/xlink" ','version="1.1" ','width="',(h.viewBox?h.viewBox.width:this.width),'" ','height="',(h.viewBox?h.viewBox.height:this.height),'" ',(this.backgroundColor&&!this.backgroundColor.source?'style="background-color: '+this.backgroundColor+'" ':null),(h.viewBox?'viewBox="'+h.viewBox.x+" "+h.viewBox.y+" "+h.viewBox.width+" "+h.viewBox.height+'" ':null),'xml:space="preserve">',"<desc>Created with Fabric.js ",fabric.version,"</desc>","<defs>",fabric.createSVGFontFacesMarkup(this.getObjects()),fabric.createSVGRefElementsMarkup(this),"</defs>");if(this.backgroundColor&&this.backgroundColor.source){g.push('<rect x="0" y="0" ','width="',(this.backgroundColor.repeat==="repeat-y"||this.backgroundColor.repeat==="no-repeat"?this.backgroundColor.source.width:this.width),'" height="',(this.backgroundColor.repeat==="repeat-x"||this.backgroundColor.repeat==="no-repeat"?this.backgroundColor.source.height:this.height),'" fill="url(#backgroundColorPattern)"',"></rect>")}if(this.backgroundImage){g.push('<image x="0" y="0" ','width="',(this.backgroundImageStretch?this.width:this.backgroundImage.width),'" height="',(this.backgroundImageStretch?this.height:this.backgroundImage.height),'" preserveAspectRatio="',(this.backgroundImageStretch?"none":"defer"),'" xlink:href="',this.backgroundImage.src,'" style="opacity:',this.backgroundImageOpacity,'"></image>')}if(this.overlayImage){g.push('<image x="',this.overlayImageLeft,'" y="',this.overlayImageTop,'" width="',this.overlayImage.width,'" height="',this.overlayImage.height,'" xlink:href="',this.overlayImage.src,'"></image>')}for(var j=0,k=this.getObjects(),f=k.length;j<f;j++){g.push(k[j].toSVG())}g.push("</svg>");return g.join("")},remove:function(f){if(this.getActiveObject()===f){this.fire("before:selection:cleared",{target:f});this.discardActiveObject();this.fire("selection:cleared")}return fabric.Collection.remove.call(this,f)},sendToBack:function(f){d(this._objects,f);this._objects.unshift(f);return this.renderAll&&this.renderAll()},bringToFront:function(f){d(this._objects,f);this._objects.push(f);return this.renderAll&&this.renderAll()},sendBackwards:function(j){var g=this._objects.indexOf(j),f=g;if(g!==0){for(var k=g-1;k>=0;--k){var h=j.intersectsWithObject(this._objects[k])||j.isContainedWithinObject(this._objects[k])||this._objects[k].isContainedWithinObject(j);if(h){f=k;break}}d(this._objects,j);this._objects.splice(f,0,j)}return this.renderAll&&this.renderAll()},bringForward:function(k){var n=this.getObjects(),g=n.indexOf(k),f=g;if(g!==n.length-1){for(var m=g+1,j=this._objects.length;m<j;++m){var h=k.intersectsWithObject(n[m])||k.isContainedWithinObject(this._objects[m])||this._objects[m].isContainedWithinObject(k);if(h){f=m;break}}d(n,k);n.splice(f,0,k)}return this.renderAll&&this.renderAll()},moveTo:function(g,f){d(this._objects,g);this._objects.splice(f,0,g);return this.renderAll&&this.renderAll()},dispose:function(){this.clear();if(!this.interactive){return this}if(fabric.isTouchSupported){b(this.upperCanvasEl,"touchstart",this._onMouseDown);b(this.upperCanvasEl,"touchmove",this._onMouseMove);if(typeof Event!=="undefined"&&"remove" in Event){Event.remove(this.upperCanvasEl,"gesture",this._onGesture)}}else{b(this.upperCanvasEl,"mousedown",this._onMouseDown);b(this.upperCanvasEl,"mousemove",this._onMouseMove);b(fabric.window,"resize",this._onResize)}return this},_resizeImageToFit:function(h){var g=h.width||h.offsetWidth,f=this.getWidth()/g;if(g){h.width=g*f}}});fabric.StaticCanvas.prototype.toString=function(){return"#<fabric.Canvas ("+this.complexity()+"): { objects: "+this.getObjects().length+" }>"};e(fabric.StaticCanvas,{EMPTY_JSON:'{"objects": [], "background": "white"}',toGrayscale:function(k){var h=k.getContext("2d"),f=h.getImageData(0,0,k.width,k.height),o=f.data,l=f.width,q=f.height,p,g,n,m;for(n=0;n<l;n++){for(m=0;m<q;m++){p=(n*4)*q+(m*4);g=(o[p]+o[p+1]+o[p+2])/3;o[p]=g;o[p+1]=g;o[p+2]=g}}h.putImageData(f,0,0)},supports:function(g){var h=fabric.util.createCanvasElement();if(!h||!h.getContext){return null}var f=h.getContext("2d");if(!f){return null}switch(g){case"getImageData":return typeof f.getImageData!=="undefined";case"toDataURL":return typeof h.toDataURL!=="undefined";case"toDataURLWithQuality":try{h.toDataURL("image/jpeg",0);return true}catch(i){}return false;default:return null}}});fabric.StaticCanvas.prototype.toJSON=fabric.StaticCanvas.prototype.toObject})();fabric.util.object.extend(fabric.StaticCanvas.prototype,{FX_DURATION:500,fxCenterObjectH:function(b,c){c=c||{};var d=function(){},e=c.onComplete||d,a=c.onChange||d,f=this;fabric.util.animate({startValue:b.get("left"),endValue:this.getCenter().left,duration:this.FX_DURATION,onChange:function(g){b.set("left",g);f.renderAll();a()},onComplete:function(){b.setCoords();e()}});return this},fxCenterObjectV:function(b,c){c=c||{};var d=function(){},e=c.onComplete||d,a=c.onChange||d,f=this;fabric.util.animate({startValue:b.get("top"),endValue:this.getCenter().top,duration:this.FX_DURATION,onChange:function(g){b.set("top",g);f.renderAll();a()},onComplete:function(){b.setCoords();e()}});return this},fxRemove:function(b,c){c=c||{};var d=function(){},e=c.onComplete||d,a=c.onChange||d,f=this;fabric.util.animate({startValue:b.get("opacity"),endValue:0,duration:this.FX_DURATION,onStart:function(){b.set("active",false)},onChange:function(g){b.set("opacity",g);f.renderAll();a()},onComplete:function(){f.remove(b);e()}});return this}});(function(b){var f=b.fabric||(b.fabric={}),i=f.util.object.extend,d=f.util.toFixed,h=f.util.string.capitalize,c=f.util.degreesToRadians;if(f.Object){return}var a=b.Image;try{var e=(typeof require!=="undefined")&&require("canvas").Image;if(e){a=e}}catch(g){f.log(g)}f.Object=f.util.createClass({type:"object",originX:"center",originY:"center",top:0,left:0,width:0,height:0,scaleX:1,scaleY:1,flipX:false,flipY:false,opacity:1,angle:0,cornerSize:12,transparentCorners:true,padding:0,borderColor:"rgba(102,153,255,0.75)",cornerColor:"rgba(102,153,255,0.5)",fill:"rgb(0,0,0)",fillRule:"source-over",overlayFill:null,stroke:null,strokeWidth:1,strokeDashArray:null,shadow:null,borderOpacityWhenMoving:0.4,borderScaleFactor:1,transformMatrix:null,minScaleLimit:0.01,selectable:true,visible:true,hasControls:true,hasBorders:true,hasRotatingPoint:true,rotatingPointOffset:40,perPixelTargetFind:false,includeDefaultValues:true,clipTo:null,stateProperties:("top left width height scaleX scaleY flipX flipY angle opacity cornerSize fill overlayFill originX originY stroke strokeWidth strokeDashArray fillRule borderScaleFactor transformMatrix selectable shadow visible").split(" "),initialize:function(j){if(j){this.setOptions(j)}},_initGradient:function(j){if(j.fill&&j.fill.colorStops&&!(j.fill instanceof f.Gradient)){this.set("fill",new f.Gradient(j.fill))}},_initPattern:function(j){if(j.fill&&j.fill.source&&!(j.fill instanceof f.Pattern)){this.set("fill",new f.Pattern(j.fill))}if(j.stroke&&j.stroke.source&&!(j.stroke instanceof f.Pattern)){this.set("stroke",new f.Pattern(j.stroke))}},_initShadow:function(j){if(j.shadow&&!(j.shadow instanceof f.Shadow)){this.setShadow(j.shadow)}},setOptions:function(j){for(var k in j){this.set(k,j[k])}this._initGradient(j);this._initPattern(j);this._initShadow(j)},transform:function(k){k.globalAlpha=this.opacity;var j=this.getCenterPoint();k.translate(j.x,j.y);k.rotate(c(this.angle));k.scale(this.scaleX*(this.flipX?-1:1),this.scaleY*(this.flipY?-1:1))},toObject:function(l){var k=f.Object.NUM_FRACTION_DIGITS;var j={type:this.type,originX:this.originX,originY:this.originY,left:d(this.left,k),top:d(this.top,k),width:d(this.width,k),height:d(this.height,k),fill:(this.fill&&this.fill.toObject)?this.fill.toObject():this.fill,overlayFill:this.overlayFill,stroke:(this.stroke&&this.stroke.toObject)?this.stroke.toObject():this.stroke,strokeWidth:this.strokeWidth,strokeDashArray:this.strokeDashArray,scaleX:d(this.scaleX,k),scaleY:d(this.scaleY,k),angle:d(this.getAngle(),k),flipX:this.flipX,flipY:this.flipY,opacity:d(this.opacity,k),selectable:this.selectable,hasControls:this.hasControls,hasBorders:this.hasBorders,hasRotatingPoint:this.hasRotatingPoint,transparentCorners:this.transparentCorners,perPixelTargetFind:this.perPixelTargetFind,shadow:(this.shadow&&this.shadow.toObject)?this.shadow.toObject():this.shadow,visible:this.visible};if(!this.includeDefaultValues){j=this._removeDefaultValues(j)}f.util.populateWithProperties(this,j,l);return j},toDatalessObject:function(j){return this.toObject(j)},getSvgStyles:function(){return["stroke: ",(this.stroke?this.stroke:"none"),"; ","stroke-width: ",(this.strokeWidth?this.strokeWidth:"0"),"; ","stroke-dasharray: ",(this.strokeDashArray?this.strokeDashArray.join(" "):"; "),"fill: ",(this.fill?(this.fill&&this.fill.toLive?"url(#SVGID_"+this.fill.id+")":this.fill):"none"),"; ","opacity: ",(this.opacity?this.opacity:"1"),";",(this.visible?"":" visibility: hidden;")].join("")},getSvgTransform:function(){var o=this.getAngle();var k=this.getCenterPoint();var m=f.Object.NUM_FRACTION_DIGITS;var j="translate("+d(k.x,m)+" "+d(k.y,m)+")";var l=o!==0?(" rotate("+d(o,m)+")"):"";var q=(this.scaleX===1&&this.scaleY===1)?"":(" scale("+d(this.scaleX,m)+" "+d(this.scaleY,m)+")");var p=this.flipX?"matrix(-1 0 0 1 0 0) ":"";var n=this.flipY?"matrix(1 0 0 -1 0 0)":"";return[j,l,q,p,n].join("")},_removeDefaultValues:function(k){var j=f.Object.prototype.options;if(j){this.stateProperties.forEach(function(l){if(k[l]===j[l]){delete k[l]}})}return k},toString:function(){return"#<fabric."+h(this.type)+">"},get:function(j){return this[j]},set:function(j,k){if(typeof j==="object"){for(var l in j){this._set(l,j[l])}}else{if(typeof k==="function"){this._set(j,k(this.get(j)))}else{this._set(j,k)}}return this},_set:function(j,k){var l=(j==="scaleX"||j==="scaleY");if(l){k=this._constrainScale(k)}if(j==="scaleX"&&k<0){this.flipX=!this.flipX;k*=-1}else{if(j==="scaleY"&&k<0){this.flipY=!this.flipY;k*=-1}else{if(j==="width"||j==="height"){this.minScaleLimit=d(Math.min(0.1,1/Math.max(this.width,this.height)),2)}}}this[j]=k;return this},toggle:function(k){var j=this.get(k);if(typeof j==="boolean"){this.set(k,!j)}return this},setSourcePath:function(j){this.sourcePath=j;return this},render:function(k,l){if(this.width===0||this.height===0||!this.visible){return}k.save();var j=this.transformMatrix;if(j&&!this.group){k.setTransform(j[0],j[1],j[2],j[3],j[4],j[5])}if(!l){this.transform(k)}if(this.stroke||this.strokeDashArray){k.lineWidth=this.strokeWidth;if(this.stroke&&this.stroke.toLive){k.strokeStyle=this.stroke.toLive(k)}else{k.strokeStyle=this.stroke}}if(this.overlayFill){k.fillStyle=this.overlayFill}else{if(this.fill){k.fillStyle=this.fill.toLive?this.fill.toLive(k):this.fill}}if(j&&this.group){k.translate(-this.group.width/2,-this.group.height/2);k.transform(j[0],j[1],j[2],j[3],j[4],j[5])}this._setShadow(k);this.clipTo&&f.util.clipContext(this,k);this._render(k,l);this.clipTo&&k.restore();this._removeShadow(k);if(this.active&&!l){this.drawBorders(k);this.drawControls(k)}k.restore()},_setShadow:function(j){if(!this.shadow){return}j.shadowColor=this.shadow.color;j.shadowBlur=this.shadow.blur;j.shadowOffsetX=this.shadow.offsetX;j.shadowOffsetY=this.shadow.offsetY},_removeShadow:function(j){j.shadowColor="";j.shadowBlur=j.shadowOffsetX=j.shadowOffsetY=0},clone:function(k,j){if(this.constructor.fromObject){return this.constructor.fromObject(this.toObject(j),k)}return new f.Object(this.toObject(j))},cloneAsImage:function(l){if(f.Image){var j=new a();j.onload=function(){if(l){l(new f.Image(j),k)}j=j.onload=null};var k={angle:this.getAngle(),flipX:this.getFlipX(),flipY:this.getFlipY()};this.set({angle:0,flipX:false,flipY:false});this.toDataURL(function(m){j.src=m})}return this},toDataURL:function(m){var k=f.util.createCanvasElement();k.width=this.getBoundingRectWidth();k.height=this.getBoundingRectHeight();f.util.wrapElement(k,"div");var j=new f.Canvas(k);j.backgroundColor="transparent";j.renderAll();if(this.constructor.async){this.clone(l)}else{l(this.clone())}function l(o){o.left=k.width/2;o.top=k.height/2;o.set("active",false);j.add(o);var n=j.toDataURL();j.dispose();j=o=null;m&&m(n)}},hasStateChanged:function(){return this.stateProperties.some(function(j){return this[j]!==this.originalState[j]},this)},saveState:function(j){this.stateProperties.forEach(function(k){this.originalState[k]=this.get(k)},this);if(j&&j.stateProperties){j.stateProperties.forEach(function(k){this.originalState[k]=this.get(k)},this)}return this},setupState:function(){this.originalState={};this.saveState()},isType:function(j){return this.type===j},toGrayscale:function(){var j=this.get("fill");if(j){this.set("overlayFill",new f.Color(j).toGrayscale().toRgb())}return this},complexity:function(){return 0},toJSON:function(j){return this.toObject(j)},setGradient:function(m,l){l||(l={});var n={colorStops:[]};n.type=l.type||(l.r1||l.r2?"radial":"linear");n.coords={x1:l.x1,y1:l.y1,x2:l.x2,y2:l.y2};if(l.r1||l.r2){n.coords.r1=l.r1;n.coords.r2=l.r2}for(var j in l.colorStops){var k=new f.Color(l.colorStops[j]);n.colorStops.push({offset:j,color:k.toRgb(),opacity:k.getAlpha()})}this.set(m,f.Gradient.forObject(this,n))},setPatternFill:function(j){return this.set("fill",new f.Pattern(j))},setShadow:function(j){return this.set("shadow",new f.Shadow(j))},animate:function(){if(arguments[0]&&typeof arguments[0]==="object"){var n=[],m,k;for(m in arguments[0]){n.push(m)}for(var l=0,j=n.length;l<j;l++){m=n[l];k=l!==j-1;this._animate(m,arguments[0][m],arguments[1],k)}}else{this._animate.apply(this,arguments)}return this},_animate:function(n,p,l,j){var o=this,k;p=p.toString();if(!l){l={}}else{l=f.util.object.clone(l)}if(~n.indexOf(".")){k=n.split(".")}var m=k?this.get(k[0])[k[1]]:this.get(n);if(!("from" in l)){l.from=m}if(~p.indexOf("=")){p=m+parseFloat(p.replace("=",""))}else{p=parseFloat(p)}f.util.animate({startValue:l.from,endValue:p,byValue:l.by,easing:l.easing,duration:l.duration,onChange:function(q){if(k){o[k[0]][k[1]]=q}else{o.set(n,q)}if(j){return}l.onChange&&l.onChange()},onComplete:function(){if(j){return}o.setCoords();l.onComplete&&l.onComplete()}})},centerH:function(){this.canvas.centerObjectH(this);return this},centerV:function(){this.canvas.centerObjectV(this);return this},center:function(){return this.centerH().centerV()},remove:function(){return this.canvas.remove(this)},sendToBack:function(){if(this.group){f.StaticCanvas.prototype.sendToBack.call(this.group,this)}else{this.canvas.sendToBack(this)}return this},bringToFront:function(){if(this.group){f.StaticCanvas.prototype.bringToFront.call(this.group,this)}else{this.canvas.bringToFront(this)}return this},sendBackwards:function(){if(this.group){f.StaticCanvas.prototype.sendBackwards.call(this.group,this)}else{this.canvas.sendBackwards(this)}return this},bringForward:function(){if(this.group){f.StaticCanvas.prototype.bringForward.call(this.group,this)}else{this.canvas.bringForward(this)}return this},moveTo:function(j){if(this.group){f.StaticCanvas.prototype.moveTo.call(this.group,this,j)}else{this.canvas.moveTo(this,j)}return this}});f.util.createAccessors(f.Object);f.Object.prototype.rotate=f.Object.prototype.setAngle;i(f.Object.prototype,f.Observable);f.Object.NUM_FRACTION_DIGITS=2;f.Object.__uid=0})(typeof exports!=="undefined"?exports:this);(function(){var a=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{translateToCenterPoint:function(c,e,d){var b=c.x,f=c.y;if(e==="left"){b=c.x+this.getWidth()/2}else{if(e==="right"){b=c.x-this.getWidth()/2}}if(d==="top"){f=c.y+this.getHeight()/2}else{if(d==="bottom"){f=c.y-this.getHeight()/2}}return fabric.util.rotatePoint(new fabric.Point(b,f),c,a(this.angle))},translateToOriginPoint:function(c,e,d){var b=c.x,f=c.y;if(e==="left"){b=c.x-this.getWidth()/2}else{if(e==="right"){b=c.x+this.getWidth()/2}}if(d==="top"){f=c.y-this.getHeight()/2}else{if(d==="bottom"){f=c.y+this.getHeight()/2}}return fabric.util.rotatePoint(new fabric.Point(b,f),c,a(this.angle))},getCenterPoint:function(){return this.translateToCenterPoint(new fabric.Point(this.left,this.top),this.originX,this.originY)},toLocalPoint:function(d,f,e){var c=this.getCenterPoint();var b,g;if(f!==undefined&&e!==undefined){if(f==="left"){b=c.x-this.getWidth()/2}else{if(f==="right"){b=c.x+this.getWidth()/2}else{b=c.x}}if(e==="top"){g=c.y-this.getHeight()/2}else{if(e==="bottom"){g=c.y+this.getHeight()/2}else{g=c.y}}}else{b=this.left;g=this.top}return fabric.util.rotatePoint(new fabric.Point(d.x,d.y),c,-a(this.angle)).subtractEquals(new fabric.Point(b,g))},setPositionByOrigin:function(f,e,d){var c=this.translateToCenterPoint(f,e,d);var b=this.translateToOriginPoint(c,this.originX,this.originY);this.set("left",b.x);this.set("top",b.y)},adjustPosition:function(i){var g=a(this.angle);var h=this.getWidth()/2;var f=Math.cos(g)*h;var c=Math.sin(g)*h;var e=this.getWidth();var d=Math.cos(g)*e;var b=Math.sin(g)*e;if(this.originX==="center"&&i==="left"||this.originX==="right"&&i==="center"){this.left-=f;this.top-=c}else{if(this.originX==="left"&&i==="center"||this.originX==="center"&&i==="right"){this.left+=f;this.top+=c}else{if(this.originX==="left"&&i==="right"){this.left+=d;this.top+=b}else{if(this.originX==="right"&&i==="left"){this.left-=d;this.top-=b}}}}this.setCoords();this.originX=i}})})();(function(){var a=fabric.util.degreesToRadians;fabric.util.object.extend(fabric.Object.prototype,{intersectsWithRect:function(d,f){var i=this.oCoords,b=new fabric.Point(i.tl.x,i.tl.y),e=new fabric.Point(i.tr.x,i.tr.y),h=new fabric.Point(i.bl.x,i.bl.y),c=new fabric.Point(i.br.x,i.br.y);var g=fabric.Intersection.intersectPolygonRectangle([b,e,c,h],d,f);return g.status==="Intersection"},intersectsWithObject:function(b){function c(g){return{tl:new fabric.Point(g.tl.x,g.tl.y),tr:new fabric.Point(g.tr.x,g.tr.y),bl:new fabric.Point(g.bl.x,g.bl.y),br:new fabric.Point(g.br.x,g.br.y)}}var d=c(this.oCoords),f=c(b.oCoords);var e=fabric.Intersection.intersectPolygonPolygon([d.tl,d.tr,d.br,d.bl],[f.tl,f.tr,f.br,f.bl]);return e.status==="Intersection"},isContainedWithinObject:function(b){return this.isContainedWithinRect(b.oCoords.tl,b.oCoords.br)},isContainedWithinRect:function(c,e){var g=this.oCoords,b=new fabric.Point(g.tl.x,g.tl.y),d=new fabric.Point(g.tr.x,g.tr.y),f=new fabric.Point(g.bl.x,g.bl.y);return b.x>c.x&&d.x<e.x&&b.y>c.y&&f.y<e.y},getBoundingRectWidth:function(){return this.getBoundingRect().width},getBoundingRectHeight:function(){return this.getBoundingRect().height},getBoundingRect:function(){this.oCoords||this.setCoords();var d=[this.oCoords.tl.x,this.oCoords.tr.x,this.oCoords.br.x,this.oCoords.bl.x];var c=fabric.util.array.min(d);var h=fabric.util.array.max(d);var f=Math.abs(c-h);var e=[this.oCoords.tl.y,this.oCoords.tr.y,this.oCoords.br.y,this.oCoords.bl.y];var i=fabric.util.array.min(e);var g=fabric.util.array.max(e);var b=Math.abs(i-g);return{left:c,top:i,width:f,height:b}},getWidth:function(){return this.width*this.scaleX},getHeight:function(){return this.height*this.scaleY},_constrainScale:function(b){if(Math.abs(b)<this.minScaleLimit){if(b<0){return -this.minScaleLimit}else{return this.minScaleLimit}}return b},scale:function(b){b=this._constrainScale(b);if(b<0){this.flipX=!this.flipX;this.flipY=!this.flipY;b*=-1}this.scaleX=b;this.scaleY=b;this.setCoords();return this},scaleToWidth:function(c){var b=this.getBoundingRectWidth()/this.getWidth();return this.scale(c/this.width/b)},scaleToHeight:function(c){var b=this.getBoundingRectHeight()/this.getHeight();return this.scale(c/this.height/b)},setCoords:function(){var k=this.strokeWidth>1?this.strokeWidth:0,i=this.padding,g=a(this.angle);this.currentWidth=(this.width+k)*this.scaleX+i*2;this.currentHeight=(this.height+k)*this.scaleY+i*2;if(this.currentWidth<0){this.currentWidth=Math.abs(this.currentWidth)}var j=Math.sqrt(Math.pow(this.currentWidth/2,2)+Math.pow(this.currentHeight/2,2));var h=Math.atan(this.currentHeight/this.currentWidth);var s=Math.cos(h+g)*j,r=Math.sin(h+g)*j,q=Math.sin(g),l=Math.cos(g);var o=this.getCenterPoint();var e={x:o.x-s,y:o.y-r};var c={x:e.x+(this.currentWidth*l),y:e.y+(this.currentWidth*q)};var t={x:c.x-(this.currentHeight*q),y:c.y+(this.currentHeight*l)};var d={x:e.x-(this.currentHeight*q),y:e.y+(this.currentHeight*l)};var p={x:e.x-(this.currentHeight/2*q),y:e.y+(this.currentHeight/2*l)};var m={x:e.x+(this.currentWidth/2*l),y:e.y+(this.currentWidth/2*q)};var n={x:c.x-(this.currentHeight/2*q),y:c.y+(this.currentHeight/2*l)};var b={x:d.x+(this.currentWidth/2*l),y:d.y+(this.currentWidth/2*q)};var f={x:e.x+(this.currentWidth/2*l),y:e.y+(this.currentWidth/2*q)};this.oCoords={tl:e,tr:c,br:t,bl:d,ml:p,mt:m,mr:n,mb:b,mtr:f};this._setCornerCoords();return this}})})();(function(b){var c=b.fabric||(b.fabric={}),d=c.util.object.extend,a={x1:1,x2:1,y1:1,y2:1};if(c.Line){c.warn("fabric.Line is already defined");return}c.Line=c.util.createClass(c.Object,{type:"line",initialize:function(f,e){e=e||{};if(!f){f=[0,0,0,0]}this.callSuper("initialize",e);this.set("x1",f[0]);this.set("y1",f[1]);this.set("x2",f[2]);this.set("y2",f[3]);this._setWidthHeight(e)},_setWidthHeight:function(e){e||(e={});this.set("width",(this.x2-this.x1)||1);this.set("height",(this.y2-this.y1)||1);this.set("left","left" in e?e.left:(this.x1+this.width/2));this.set("top","top" in e?e.top:(this.y1+this.height/2))},_set:function(e,f){this[e]=f;if(e in a){this._setWidthHeight()}return this},_render:function(f){f.beginPath();var e=this.group&&this.group.type!=="group";if(e){f.translate(-this.group.width/2+this.left,-this.group.height/2+this.top)}f.moveTo(this.width===1?0:(-this.width/2),this.height===1?0:(-this.height/2));f.lineTo(this.width===1?0:(this.width/2),this.height===1?0:(this.height/2));f.lineWidth=this.strokeWidth;var g=f.strokeStyle;f.strokeStyle=f.fillStyle;f.stroke();f.strokeStyle=g},complexity:function(){return 1},toObject:function(e){return d(this.callSuper("toObject",e),{x1:this.get("x1"),y1:this.get("y1"),x2:this.get("x2"),y2:this.get("y2")})},toSVG:function(){var e=[];if(this.stroke&&this.stroke.toLive){e.push(this.stroke.toSVG(this,true))}e.push("<line ",'x1="',this.get("x1"),'" y1="',this.get("y1"),'" x2="',this.get("x2"),'" y2="',this.get("y2"),'" style="',this.getSvgStyles(),'"/>');return e.join("")}});c.Line.ATTRIBUTE_NAMES="x1 y1 x2 y2 stroke stroke-width transform".split(" ");c.Line.fromElement=function(f,e){var h=c.parseAttributes(f,c.Line.ATTRIBUTE_NAMES);var g=[h.x1||0,h.y1||0,h.x2||0,h.y2||0];return new c.Line(g,d(h,e))};c.Line.fromObject=function(e){var f=[e.x1,e.y1,e.x2,e.y2];return new c.Line(f,e)}})(typeof exports!=="undefined"?exports:this);(function(a){var b=a.fabric||(a.fabric={}),d=Math.PI*2,e=b.util.object.extend;if(b.Circle){b.warn("fabric.Circle is already defined.");return}b.Circle=b.util.createClass(b.Object,{type:"circle",initialize:function(f){f=f||{};this.set("radius",f.radius||0);this.callSuper("initialize",f);var g=this.get("radius")*2;this.set("width",g).set("height",g)},toObject:function(f){return e(this.callSuper("toObject",f),{radius:this.get("radius")})},toSVG:function(){var f=[];if(this.fill&&this.fill.toLive){f.push(this.fill.toSVG(this,false))}if(this.stroke&&this.stroke.toLive){f.push(this.stroke.toSVG(this,false))}f.push("<circle ",'cx="0" cy="0" ','r="',this.radius,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return f.join("")},_render:function(f,g){f.beginPath();f.globalAlpha=this.group?(f.globalAlpha*this.opacity):this.opacity;f.arc(g?this.left:0,g?this.top:0,this.radius,0,d,false);f.closePath();if(this.fill){f.fill()}this._removeShadow(f);if(this.stroke){f.stroke()}},getRadiusX:function(){return this.get("radius")*this.get("scaleX")},getRadiusY:function(){return this.get("radius")*this.get("scaleY")},setRadius:function(f){this.radius=f;this.set("width",f*2).set("height",f*2)},complexity:function(){return 1}});b.Circle.ATTRIBUTE_NAMES="cx cy r fill fill-opacity opacity stroke stroke-width transform".split(" ");b.Circle.fromElement=function(g,f){f||(f={});var h=b.parseAttributes(g,b.Circle.ATTRIBUTE_NAMES);if(!c(h)){throw new Error("value of `r` attribute is required and can not be negative")}if("left" in h){h.left-=(f.width/2)||0}if("top" in h){h.top-=(f.height/2)||0}var i=new b.Circle(e(h,f));i.cx=parseFloat(g.getAttribute("cx"))||0;i.cy=parseFloat(g.getAttribute("cy"))||0;return i};function c(f){return(("radius" in f)&&(f.radius>0))}b.Circle.fromObject=function(f){return new b.Circle(f)}})(typeof exports!=="undefined"?exports:this);(function(a){var b=a.fabric||(a.fabric={});if(b.Triangle){b.warn("fabric.Triangle is already defined");return}b.Triangle=b.util.createClass(b.Object,{type:"triangle",initialize:function(c){c=c||{};this.callSuper("initialize",c);this.set("width",c.width||100).set("height",c.height||100)},_render:function(c){var d=this.width/2,e=this.height/2;c.beginPath();c.moveTo(-d,e);c.lineTo(0,-e);c.lineTo(d,e);c.closePath();if(this.fill){c.fill()}if(this.stroke){c.stroke()}},complexity:function(){return 1},toSVG:function(){var c=[],d=this.width/2,e=this.height/2;var f=[-d+" "+e,"0 "+-e,d+" "+e].join(",");if(this.fill&&this.fill.toLive){c.push(this.fill.toSVG(this,true))}if(this.stroke&&this.stroke.toLive){c.push(this.stroke.toSVG(this,true))}c.push("<polygon ",'points="',f,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return c.join("")}});b.Triangle.fromObject=function(c){return new b.Triangle(c)}})(typeof exports!=="undefined"?exports:this);(function(a){var b=a.fabric||(a.fabric={}),c=Math.PI*2,d=b.util.object.extend;if(b.Ellipse){b.warn("fabric.Ellipse is already defined.");return}b.Ellipse=b.util.createClass(b.Object,{type:"ellipse",rx:0,ry:0,initialize:function(e){e=e||{};this.callSuper("initialize",e);this.set("rx",e.rx||0);this.set("ry",e.ry||0);this.set("width",this.get("rx")*2);this.set("height",this.get("ry")*2)},toObject:function(e){return d(this.callSuper("toObject",e),{rx:this.get("rx"),ry:this.get("ry")})},toSVG:function(){var e=[];if(this.fill&&this.fill.toLive){e.push(this.fill.toSVG(this,false))}if(this.stroke&&this.stroke.toLive){e.push(this.stroke.toSVG(this,false))}e.push("<ellipse ",'rx="',this.get("rx"),'" ry="',this.get("ry"),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return e.join("")},render:function(e,f){if(this.rx===0||this.ry===0){return}return this.callSuper("render",e,f)},_render:function(e,f){e.beginPath();e.save();e.globalAlpha=this.group?(e.globalAlpha*this.opacity):this.opacity;if(this.transformMatrix&&this.group){e.translate(this.cx,this.cy)}e.transform(1,0,0,this.ry/this.rx,0,0);e.arc(f?this.left:0,f?this.top:0,this.rx,0,c,false);if(this.stroke){e.stroke()}this._removeShadow(e);if(this.fill){e.fill()}e.restore()},complexity:function(){return 1}});b.Ellipse.ATTRIBUTE_NAMES="cx cy rx ry fill fill-opacity opacity stroke stroke-width transform".split(" ");b.Ellipse.fromElement=function(g,f){f||(f={});var i=b.parseAttributes(g,b.Ellipse.ATTRIBUTE_NAMES);var e=i.left;var j=i.top;if("left" in i){i.left-=(f.width/2)||0}if("top" in i){i.top-=(f.height/2)||0}var h=new b.Ellipse(d(i,f));h.cx=e||0;h.cy=j||0;return h};b.Ellipse.fromObject=function(e){return new b.Ellipse(e)}})(typeof exports!=="undefined"?exports:this);(function(b){var c=b.fabric||(b.fabric={}),d=c.util.object.extend;if(c.Rect){console.warn("fabric.Rect is already defined");return}c.Rect=c.util.createClass(c.Object,{type:"rect",rx:0,ry:0,strokeDashArray:null,initialize:function(e){e=e||{};this._initStateProperties();this.callSuper("initialize",e);this._initRxRy();this.x=0;this.y=0},_initStateProperties:function(){this.stateProperties=this.stateProperties.concat(["rx","ry"])},_initRxRy:function(){if(this.rx&&!this.ry){this.ry=this.rx}else{if(this.ry&&!this.rx){this.rx=this.ry}}},_render:function(i){var l=this.rx||0,k=this.ry||0,e=-this.width/2,m=-this.height/2,g=this.width,j=this.height,f=this.group&&this.group.type!=="group";i.beginPath();i.globalAlpha=f?(i.globalAlpha*this.opacity):this.opacity;if(this.transformMatrix&&f){i.translate(this.width/2+this.x,this.height/2+this.y)}if(!this.transformMatrix&&f){i.translate(-this.group.width/2+this.width/2+this.x,-this.group.height/2+this.height/2+this.y)}i.moveTo(e+l,m);i.lineTo(e+g-l,m);i.quadraticCurveTo(e+g,m,e+g,m+k,e+g,m+k);i.lineTo(e+g,m+j-k);i.quadraticCurveTo(e+g,m+j,e+g-l,m+j,e+g-l,m+j);i.lineTo(e+l,m+j);i.quadraticCurveTo(e,m+j,e,m+j-k,e,m+j-k);i.lineTo(e,m+k);i.quadraticCurveTo(e,m,e+l,m,e+l,m);i.closePath();if(this.fill){i.fill()}this._removeShadow(i);if(this.strokeDashArray){this._renderDashedStroke(i)}else{if(this.stroke){i.stroke()}}},_renderDashedStroke:function(f){if(1&this.strokeDashArray.length){this.strokeDashArray.push.apply(this.strokeDashArray,this.strokeDashArray)}var h=0,e=-this.width/2,m=-this.height/2,l=this,k=this.padding,j=this.strokeDashArray.length;f.save();f.beginPath();function g(r,o){var n=0,p=0,i=(o?l.height:l.width)+k*2;while(n<i){var q=l.strokeDashArray[h++];n+=q;if(n>i){p=n-i}if(r){e+=(q*r)-(p*r||0)}else{m+=(q*o)-(p*o||0)}f[1&h?"moveTo":"lineTo"](e,m);if(h>=j){h=0}}}g(1,0);g(0,1);g(-1,0);g(0,-1);f.stroke();f.closePath();f.restore()},_normalizeLeftTopProperties:function(e){if("left" in e){this.set("left",e.left+this.getWidth()/2)}this.set("x",e.left||0);if("top" in e){this.set("top",e.top+this.getHeight()/2)}this.set("y",e.top||0);return this},complexity:function(){return 1},toObject:function(e){return d(this.callSuper("toObject",e),{rx:this.get("rx")||0,ry:this.get("ry")||0})},toSVG:function(){var e=[];if(this.fill&&this.fill.toLive){e.push(this.fill.toSVG(this,false))}if(this.stroke&&this.stroke.toLive){e.push(this.stroke.toSVG(this,false))}e.push("<rect ",'x="',(-1*this.width/2),'" y="',(-1*this.height/2),'" rx="',this.get("rx"),'" ry="',this.get("ry"),'" width="',this.width,'" height="',this.height,'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return e.join("")}});c.Rect.ATTRIBUTE_NAMES="x y width height rx ry fill fill-opacity opacity stroke stroke-width transform".split(" ");function a(e){e.left=e.left||0;e.top=e.top||0;return e}c.Rect.fromElement=function(f,e){if(!f){return null}var h=c.parseAttributes(f,c.Rect.ATTRIBUTE_NAMES);h=a(h);var g=new c.Rect(d((e?c.util.object.clone(e):{}),h));g._normalizeLeftTopProperties(h);return g};c.Rect.fromObject=function(e){return new c.Rect(e)}})(typeof exports!=="undefined"?exports:this);(function(b){var c=b.fabric||(b.fabric={}),a=c.util.toFixed;if(c.Polyline){c.warn("fabric.Polyline is already defined");return}c.Polyline=c.util.createClass(c.Object,{type:"polyline",initialize:function(e,d,f){d=d||{};this.set("points",e);this.callSuper("initialize",d);this._calcDimensions(f)},_calcDimensions:function(d){return c.Polygon.prototype._calcDimensions.call(this,d)},toObject:function(d){return c.Polygon.prototype.toObject.call(this,d)},toSVG:function(){var g=[],e=[];for(var f=0,d=this.points.length;f<d;f++){g.push(a(this.points[f].x,2),",",a(this.points[f].y,2)," ")}if(this.fill&&this.fill.toLive){e.push(this.fill.toSVG(this,false))}if(this.stroke&&this.stroke.toLive){e.push(this.stroke.toSVG(this,false))}e.push("<polyline ",'points="',g.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return e.join("")},_render:function(f){var e;f.beginPath();f.moveTo(this.points[0].x,this.points[0].y);for(var g=0,d=this.points.length;g<d;g++){e=this.points[g];f.lineTo(e.x,e.y)}if(this.fill){f.fill()}this._removeShadow(f);if(this.stroke){f.stroke()}},complexity:function(){return this.get("points").length}});c.Polyline.ATTRIBUTE_NAMES="fill fill-opacity opacity stroke stroke-width transform".split(" ");c.Polyline.fromElement=function(g,e){if(!g){return null}e||(e={});var h=c.parsePointsAttribute(g.getAttribute("points")),j=c.parseAttributes(g,c.Polyline.ATTRIBUTE_NAMES);for(var f=0,d=h.length;f<d;f++){h[f].x-=(e.width/2)||0;h[f].y-=(e.height/2)||0}return new c.Polyline(h,c.util.object.extend(j,e),true)};c.Polyline.fromObject=function(d){var e=d.points;return new c.Polyline(e,d,true)}})(typeof exports!=="undefined"?exports:this);(function(d){var e=d.fabric||(d.fabric={}),f=e.util.object.extend,c=e.util.array.min,b=e.util.array.max,a=e.util.toFixed;if(e.Polygon){e.warn("fabric.Polygon is already defined");return}e.Polygon=e.util.createClass(e.Object,{type:"polygon",initialize:function(h,g,i){g=g||{};this.points=h;this.callSuper("initialize",g);this._calcDimensions(i)},_calcDimensions:function(l){var i=this.points,h=c(i,"x"),n=c(i,"y"),k=b(i,"x"),j=b(i,"y");this.width=(k-h)||1;this.height=(j-n)||1;this.minX=h;this.minY=n;if(l){return}var m=this.width/2,g=this.height/2;this.points.forEach(function(o){o.x-=m;o.y-=g},this)},toObject:function(g){return f(this.callSuper("toObject",g),{points:this.points.concat()})},toSVG:function(){var k=[],h=[];for(var j=0,g=this.points.length;j<g;j++){k.push(a(this.points[j].x,2),",",a(this.points[j].y,2)," ")}if(this.fill&&this.fill.toLive){h.push(this.fill.toSVG(this,false))}if(this.stroke&&this.stroke.toLive){h.push(this.stroke.toSVG(this,false))}h.push("<polygon ",'points="',k.join(""),'" style="',this.getSvgStyles(),'" transform="',this.getSvgTransform(),'"/>');return h.join("")},_render:function(j){var h;j.beginPath();j.moveTo(this.points[0].x,this.points[0].y);for(var k=0,g=this.points.length;k<g;k++){h=this.points[k];j.lineTo(h.x,h.y)}if(this.fill){j.fill()}this._removeShadow(j);if(this.stroke){j.closePath();j.stroke()}},complexity:function(){return this.points.length}});e.Polygon.ATTRIBUTE_NAMES="fill fill-opacity opacity stroke stroke-width transform".split(" ");e.Polygon.fromElement=function(k,h){if(!k){return null}h||(h={});var l=e.parsePointsAttribute(k.getAttribute("points")),m=e.parseAttributes(k,e.Polygon.ATTRIBUTE_NAMES);for(var j=0,g=l.length;j<g;j++){l[j].x-=(h.width/2)||0;l[j].y-=(h.height/2)||0}return new e.Polygon(l,f(m,h),true)};e.Polygon.fromObject=function(g){return new e.Polygon(g.points,g,true)}})(typeof exports!=="undefined"?exports:this);(function(a){var l={m:2,l:2,h:1,v:1,c:6,s:4,q:4,t:2,a:7};function k(F,B,z,A){var s=A[0];var q=A[1];var t=A[2];var D=A[3];var E=A[4];var w=A[5];var v=A[6];var r=i(w,v,s,q,D,E,t,B,z);for(var u=0;u<r.length;u++){var C=f.apply(this,r[u]);F.bezierCurveTo.apply(F,C)}}var b={},p={},o=Array.prototype.join,j;function i(T,S,O,N,J,P,G,M,L){j=o.call(arguments);if(b[j]){return b[j]}var r=G*(Math.PI/180);var W=Math.sin(r);var aa=Math.cos(r);O=Math.abs(O);N=Math.abs(N);var A=aa*(M-T)*0.5+W*(L-S)*0.5;var z=aa*(L-S)*0.5-W*(M-T)*0.5;var E=(A*A)/(O*O)+(z*z)/(N*N);if(E>1){E=Math.sqrt(E);O*=E;N*=E}var R=aa/O;var Q=W/O;var D=(-W)/N;var C=(aa)/N;var H=R*M+Q*L;var q=D*M+C*L;var F=R*T+Q*S;var ab=D*T+C*S;var Z=(F-H)*(F-H)+(ab-q)*(ab-q);var U=1/Z-0.25;if(U<0){U=0}var w=Math.sqrt(U);if(P===J){w=-w}var V=0.5*(H+F)-w*(ab-q);var K=0.5*(q+ab)+w*(F-H);var v=Math.atan2(q-K,H-V);var u=Math.atan2(ab-K,F-V);var Y=u-v;if(Y<0&&P===1){Y+=2*Math.PI}else{if(Y>0&&P===0){Y-=2*Math.PI}}var B=Math.ceil(Math.abs(Y/(Math.PI*0.5+0.001)));var I=[];for(var X=0;X<B;X++){var t=v+X*Y/B;var s=v+(X+1)*Y/B;I[X]=[V,K,t,s,O,N,W,aa]}b[j]=I;return I}function f(w,s,E,C,y,x,u,D){j=o.call(arguments);if(p[j]){return p[j]}var K=D*y;var J=-u*x;var A=u*y;var z=D*x;var F=0.5*(C-E);var B=(8/3)*Math.sin(F*0.5)*Math.sin(F*0.5)/Math.sin(F);var I=w+Math.cos(E)-B*Math.sin(E);var v=s+Math.sin(E)+B*Math.cos(E);var G=w+Math.cos(C);var q=s+Math.sin(C);var H=G+B*Math.sin(C);var r=q-B*Math.cos(C);p[j]=[K*I+J*v,A*I+z*v,K*H+J*r,A*H+z*r,K*G+J*q,A*G+z*q];return p[j]}"use strict";var d=a.fabric||(a.fabric={}),e=d.util.array.min,h=d.util.array.max,g=d.util.object.extend,c=Object.prototype.toString;if(d.Path){d.warn("fabric.Path is already defined");return}function n(q){if(q[0]==="H"){return q[1]}return q[q.length-2]}function m(q){if(q[0]==="V"){return q[1]}return q[q.length-1]}d.Path=d.util.createClass(d.Object,{type:"path",initialize:function(s,r){r=r||{};this.setOptions(r);if(!s){throw new Error("`path` argument is required")}var q=c.call(s)==="[object Array]";this.path=q?s:s.match&&s.match(/[mzlhvcsqta][^mzlhvcsqta]*/gi);if(!this.path){return}if(!q){this.path=this._parsePath()}this._initializePath(r);if(r.sourcePath){this.setSourcePath(r.sourcePath)}},_initializePath:function(r){var q="width" in r,t="height" in r,s="left" in r,u="top" in r;if(!q||!t){g(this,this._parseDimensions());if(q){this.width=r.width}if(t){this.height=r.height}}else{if(!u){this.top=this.height/2}if(!s){this.left=this.width/2}}this.pathOffset=this.pathOffset||this._calculatePathOffset(u||s)},_calculatePathOffset:function(q){return{x:q?0:this.left-(this.width/2),y:q?0:this.top-(this.height/2)}},_render:function(G){var C,A=null,E=0,D=0,q=0,H=0,z,w,s,r,u=-((this.width/2)+this.pathOffset.x),F=-((this.height/2)+this.pathOffset.y);for(var v=0,B=this.path.length;v<B;++v){C=this.path[v];switch(C[0]){case"l":E+=C[1];D+=C[2];G.lineTo(E+u,D+F);break;case"L":E=C[1];D=C[2];G.lineTo(E+u,D+F);break;case"h":E+=C[1];G.lineTo(E+u,D+F);break;case"H":E=C[1];G.lineTo(E+u,D+F);break;case"v":D+=C[1];G.lineTo(E+u,D+F);break;case"V":D=C[1];G.lineTo(E+u,D+F);break;case"m":E+=C[1];D+=C[2];G[(A&&(A[0]==="m"||A[0]==="M"))?"lineTo":"moveTo"](E+u,D+F);break;case"M":E=C[1];D=C[2];G[(A&&(A[0]==="m"||A[0]==="M"))?"lineTo":"moveTo"](E+u,D+F);break;case"c":z=E+C[5];w=D+C[6];q=E+C[3];H=D+C[4];G.bezierCurveTo(E+C[1]+u,D+C[2]+F,q+u,H+F,z+u,w+F);E=z;D=w;break;case"C":E=C[5];D=C[6];q=C[3];H=C[4];G.bezierCurveTo(C[1]+u,C[2]+F,q+u,H+F,E+u,D+F);break;case"s":z=E+C[3];w=D+C[4];q=q?(2*E-q):E;H=H?(2*D-H):D;G.bezierCurveTo(q+u,H+F,E+C[1]+u,D+C[2]+F,z+u,w+F);q=E+C[1];H=D+C[2];E=z;D=w;break;case"S":z=C[3];w=C[4];q=2*E-q;H=2*D-H;G.bezierCurveTo(q+u,H+F,C[1]+u,C[2]+F,z+u,w+F);E=z;D=w;q=C[1];H=C[2];break;case"q":z=E+C[3];w=D+C[4];q=E+C[1];H=D+C[2];G.quadraticCurveTo(q+u,H+F,z+u,w+F);E=z;D=w;break;case"Q":z=C[3];w=C[4];G.quadraticCurveTo(C[1]+u,C[2]+F,z+u,w+F);E=z;D=w;q=C[1];H=C[2];break;case"t":z=E+C[1];w=D+C[2];if(A[0].match(/[QqTt]/)===null){q=E;H=D}else{if(A[0]==="t"){q=2*E-s;H=2*D-r}else{if(A[0]==="q"){q=2*E-q;H=2*D-H}}}s=q;r=H;G.quadraticCurveTo(q+u,H+F,z+u,w+F);E=z;D=w;q=E+C[1];H=D+C[2];break;case"T":z=C[1];w=C[2];q=2*E-q;H=2*D-H;G.quadraticCurveTo(q+u,H+F,z+u,w+F);E=z;D=w;break;case"a":k(G,E+u,D+F,[C[1],C[2],C[3],C[4],C[5],C[6]+E+u,C[7]+D+F]);E+=C[6];D+=C[7];break;case"A":k(G,E+u,D+F,[C[1],C[2],C[3],C[4],C[5],C[6]+u,C[7]+F]);E=C[6];D=C[7];break;case"z":case"Z":G.closePath();break}A=C}},render:function(r,s){if(!this.visible){return}r.save();var q=this.transformMatrix;if(q){r.transform(q[0],q[1],q[2],q[3],q[4],q[5])}if(!s){this.transform(r)}if(this.overlayFill){r.fillStyle=this.overlayFill}else{if(this.fill){r.fillStyle=this.fill.toLive?this.fill.toLive(r):this.fill}}if(this.stroke){r.strokeStyle=this.stroke.toLive?this.stroke.toLive(r):this.stroke}this._setShadow(r);this.clipTo&&d.util.clipContext(this,r);r.beginPath();this._render(r);if(this.fill){r.fill()}this.clipTo&&r.restore();if(this.shadow&&!this.shadow.affectStroke){this._removeShadow(r)}if(this.stroke){r.strokeStyle=this.stroke;r.lineWidth=this.strokeWidth;r.lineCap=r.lineJoin="round";r.stroke()}this._removeShadow(r);if(!s&&this.active){this.drawBorders(r);this.drawControls(r)}r.restore()},toString:function(){return"#<fabric.Path ("+this.complexity()+'): { "top": '+this.top+', "left": '+this.left+" }>"},toObject:function(r){var q=g(this.callSuper("toObject",r),{path:this.path});if(this.sourcePath){q.sourcePath=this.sourcePath}if(this.transformMatrix){q.transformMatrix=this.transformMatrix}return q},toDatalessObject:function(r){var q=this.toObject(r);if(this.sourcePath){q.path=this.sourcePath}delete q.sourcePath;return q},toSVG:function(){var u=[],r=[];for(var s=0,q=this.path.length;s<q;s++){u.push(this.path[s].join(" "))}var t=u.join(" ");if(this.fill&&this.fill.toLive){r.push(this.fill.toSVG(this,true))}if(this.stroke&&this.stroke.toLive){r.push(this.stroke.toSVG(this,true))}r.push('<g transform="',(this.group?"":this.getSvgTransform()),'">',"<path ",'d="',t,'" style="',this.getSvgStyles(),'" transform="translate(',(-this.width/2)," ",(-this.height/2),")",'" stroke-linecap="round" ',"/>","</g>");return r.join("")},complexity:function(){return this.path.length},_parsePath:function(){var C=[],z,v,y;for(var u=0,q,w=this.path.length;u<w;u++){z=this.path[u];v=z.slice(1).trim().replace(/(\d)-/g,"$1###-").split(/\s|,|###/);q=[z.charAt(0)];for(var t=0,A=v.length;t<A;t++){y=parseFloat(v[t]);if(!isNaN(y)){q.push(y)}}var s=q[0].toLowerCase(),B=l[s];if(q.length-1>B){for(var r=1,x=q.length;r<x;r+=B){C.push([q[0]].concat(q.slice(r,r+B)))}}else{C.push(q)}}return C},_parseDimensions:function(){var B=[],z=[],C,A,D=false,F,E;this.path.forEach(function(y,x){if(y[0]!=="H"){C=(x===0)?n(y):n(this.path[x-1])}if(y[0]!=="V"){A=(x===0)?m(y):m(this.path[x-1])}if(y[0]===y[0].toLowerCase()){D=true}F=D?C+n(y):y[0]==="V"?C:n(y);E=D?A+m(y):y[0]==="H"?A:m(y);var G=parseInt(F,10);if(!isNaN(G)){B.push(G)}G=parseInt(E,10);if(!isNaN(G)){z.push(G)}},this);var u=e(B),t=e(z),r=h(B),q=h(z),w=r-u,v=q-t;var s={top:t+v/2,left:u+w/2,bottom:h(z)-v,right:h(B)-w};s.width=w;s.height=v;return s}});d.Path.fromObject=function(q){return new d.Path(q.path,q)};d.Path.ATTRIBUTE_NAMES="d fill fill-opacity opacity fill-rule stroke stroke-width transform".split(" ");d.Path.fromElement=function(r,q){var s=d.parseAttributes(r,d.Path.ATTRIBUTE_NAMES);return new d.Path(s.d,g(s,q))}})(typeof exports!=="undefined"?exports:this);(function(f){var g=f.fabric||(f.fabric={}),h=g.util.object.extend,b=g.util.array.invoke,e=g.Object.prototype.toObject,a=g.util.string.camelize,c=g.util.string.capitalize;if(g.PathGroup){g.warn("fabric.PathGroup is already defined");return}g.PathGroup=g.util.createClass(g.Path,{type:"path-group",fill:"",initialize:function(l,j){j=j||{};this.paths=l||[];for(var k=this.paths.length;k--;){this.paths[k].group=this}this.setOptions(j);this.setCoords();if(j.sourcePath){this.setSourcePath(j.sourcePath)}},render:function(n){if(!this.visible){return}n.save();var j=this.transformMatrix;if(j){n.transform(j[0],j[1],j[2],j[3],j[4],j[5])}this.transform(n);this._setShadow(n);this.clipTo&&g.util.clipContext(this,n);for(var o=0,k=this.paths.length;o<k;++o){this.paths[o].render(n,true)}this.clipTo&&n.restore();this._removeShadow(n);if(this.active){this.drawBorders(n);this.drawControls(n)}n.restore()},_set:function(l,k){if((l==="fill"||l==="overlayFill")&&k&&this.isSameColor()){var j=this.paths.length;while(j--){this.paths[j]._set(l,k)}}return this.callSuper("_set",l,k)},toObject:function(i){return h(e.call(this,i),{paths:b(this.getObjects(),"toObject",i),sourcePath:this.sourcePath})},toDatalessObject:function(j){var i=this.toObject(j);if(this.sourcePath){i.paths=this.sourcePath}return i},toSVG:function(){var m=this.getObjects();var k=["<g ",'style="',this.getSvgStyles(),'" ','transform="',this.getSvgTransform(),'" ',">"];for(var l=0,j=m.length;l<j;l++){k.push(m[l].toSVG())}k.push("</g>");return k.join("")},toString:function(){return"#<fabric.PathGroup ("+this.complexity()+"): { top: "+this.top+", left: "+this.left+" }>"},isSameColor:function(){var i=this.getObjects()[0].get("fill");return this.getObjects().every(function(j){return j.get("fill")===i})},complexity:function(){return this.paths.reduce(function(i,j){return i+((j&&j.complexity)?j.complexity():0)},0)},toGrayscale:function(){var j=this.paths.length;while(j--){this.paths[j].toGrayscale()}return this},getObjects:function(){return this.paths}});function d(m){for(var l=0,j=m.length;l<j;l++){if(!(m[l] instanceof g.Object)){var k=a(c(m[l].type));m[l]=g[k].fromObject(m[l])}}return m}g.PathGroup.fromObject=function(i){var j=d(i.paths);return new g.PathGroup(j,i)}})(typeof exports!=="undefined"?exports:this);(function(d){var e=d.fabric||(d.fabric={}),g=e.util.object.extend,c=e.util.array.min,a=e.util.array.max,b=e.util.array.invoke;if(e.Group){return}var f={lockMovementX:true,lockMovementY:true,lockRotation:true,lockScalingX:true,lockScalingY:true,lockUniScaling:true};e.Group=e.util.createClass(e.Object,e.Collection,{type:"group",initialize:function(k,h){h=h||{};this._objects=k||[];for(var j=this._objects.length;j--;){this._objects[j].group=this}this.originalState={};this.callSuper("initialize");this._calcBounds();this._updateObjectsCoords();if(h){g(this,h)}this._setOpacityIfSame();this.setCoords(true);this.saveCoords()},_updateObjectsCoords:function(){var i=this.left,h=this.top;this.forEachObject(function(j){var k=j.get("left"),l=j.get("top");j.set("originalLeft",k);j.set("originalTop",l);j.set("left",k-i);j.set("top",l-h);j.setCoords();j.__origHasControls=j.hasControls;j.hasControls=false},this)},toString:function(){return"#<fabric.Group: ("+this.complexity()+")>"},getObjects:function(){return this._objects},addWithUpdate:function(h){this._restoreObjectsState();this._objects.push(h);h.group=this;this.forEachObject(function(i){i.set("active",true);i.group=this},this);this._calcBounds();this._updateObjectsCoords();return this},removeWithUpdate:function(h){this._restoreObjectsState();this.forEachObject(function(i){i.set("active",true);i.group=this},this);this.remove(h);this._calcBounds();this._updateObjectsCoords();return this},_onObjectAdded:function(h){h.group=this},_onObjectRemoved:function(h){delete h.group;h.set("active",false)},delegatedProperties:{fill:true,opacity:true,fontFamily:true,fontWeight:true,fontSize:true,fontStyle:true,lineHeight:true,textDecoration:true,textShadow:true,textAlign:true,backgroundColor:true},_set:function(j,k){if(j in this.delegatedProperties){var h=this._objects.length;this[j]=k;while(h--){this._objects[h].set(j,k)}}else{this[j]=k}},toObject:function(h){return g(this.callSuper("toObject",h),{objects:b(this._objects,"toObject",h)})},render:function(k,p){if(!this.visible){return}k.save();this.transform(k);var o=Math.max(this.scaleX,this.scaleY);this.clipTo&&e.util.clipContext(this,k);for(var m=0,h=this._objects.length;m<h;m++){var l=this._objects[m],n=l.borderScaleFactor,j=l.hasRotatingPoint;if(!l.visible){continue}l.borderScaleFactor=o;l.hasRotatingPoint=false;l.render(k);l.borderScaleFactor=n;l.hasRotatingPoint=j}this.clipTo&&k.restore();if(!p&&this.active){this.drawBorders(k);this.drawControls(k)}k.restore();this.setCoords()},_restoreObjectsState:function(){this._objects.forEach(this._restoreObjectState,this);return this},_restoreObjectState:function(j){var k=this.get("left"),l=this.get("top"),h=this.getAngle()*(Math.PI/180),i=Math.cos(h)*j.get("top")+Math.sin(h)*j.get("left"),m=-Math.sin(h)*j.get("top")+Math.cos(h)*j.get("left");j.setAngle(j.getAngle()+this.getAngle());j.set("left",k+m*this.get("scaleX"));j.set("top",l+i*this.get("scaleY"));j.set("scaleX",j.get("scaleX")*this.get("scaleX"));j.set("scaleY",j.get("scaleY")*this.get("scaleY"));j.setCoords();j.hasControls=j.__origHasControls;delete j.__origHasControls;j.set("active",false);j.setCoords();delete j.group;return this},destroy:function(){return this._restoreObjectsState()},saveCoords:function(){this._originalLeft=this.get("left");this._originalTop=this.get("top");return this},hasMoved:function(){return this._originalLeft!==this.get("left")||this._originalTop!==this.get("top")},setObjectsCoords:function(){this.forEachObject(function(h){h.setCoords()});return this},_setOpacityIfSame:function(){var j=this.getObjects(),i=j[0]?j[0].get("opacity"):1;var h=j.every(function(k){return k.get("opacity")===i});if(h){this.opacity=i}},_calcBounds:function(){var s=[],q=[],p,n,k,h,m,l,u,r=0,t=this._objects.length;for(;r<t;++r){m=this._objects[r];m.setCoords();for(var j in m.oCoords){s.push(m.oCoords[j].x);q.push(m.oCoords[j].y)}}p=c(s);k=a(s);n=c(q);h=a(q);l=(k-p)||0;u=(h-n)||0;this.width=l;this.height=u;this.left=(p+l/2)||0;this.top=(n+u/2)||0},containsPoint:function(i){var l=this.get("width")/2,h=this.get("height")/2,k=this.get("left"),j=this.get("top");return k-l<i.x&&k+l>i.x&&j-h<i.y&&j+h>i.y},toSVG:function(){var j=[];for(var h=this._objects.length;h--;){j.push(this._objects[h].toSVG())}return('<g transform="'+this.getSvgTransform()+'">'+j.join("")+"</g>")},get:function(k){if(k in f){if(this[k]){return this[k]}else{for(var j=0,h=this._objects.length;j<h;j++){if(this._objects[j][k]){return true}}return false}}else{if(k in this.delegatedProperties){return this._objects[0]&&this._objects[0].get(k)}return this[k]}}});e.Group.fromObject=function(h,i){e.util.enlivenObjects(h.objects,function(j){delete h.objects;i&&i(new e.Group(j,h))})};e.Group.async=true})(typeof exports!=="undefined"?exports:this);(function(a){var b=fabric.util.object.extend;if(!a.fabric){a.fabric={}}if(a.fabric.Image){fabric.warn("fabric.Image is already defined.");return}fabric.Image=fabric.util.createClass(fabric.Object,{type:"image",initialize:function(d,c){c||(c={});this.callSuper("initialize",c);this._initElement(d);this._originalImage=this.getElement();this._initConfig(c);this.filters=[];if(c.filters){this.filters=c.filters;this.applyFilters()}},getElement:function(){return this._element},setElement:function(c){this._element=c;this._initConfig();return this},getOriginalSize:function(){var c=this.getElement();return{width:c.width,height:c.height}},render:function(e,f){if(!this.visible){return}e.save();var c=this.transformMatrix;var d=this.group&&this.group.type!=="group";if(d){e.translate(-this.group.width/2+this.width/2,-this.group.height/2+this.height/2)}if(c){e.transform(c[0],c[1],c[2],c[3],c[4],c[5])}if(!f){this.transform(e)}this._setShadow(e);this.clipTo&&fabric.util.clipContext(this,e);this._render(e);this.clipTo&&e.restore();this._removeShadow(e);if(this.stroke){this._stroke(e)}if(this.active&&!f){this.drawBorders(e);this.drawControls(e)}e.restore()},_stroke:function(c){c.save();c.lineWidth=this.strokeWidth;c.strokeStyle=this.stroke;c.strokeRect(-this.width/2,-this.height/2,this.width,this.height);c.restore()},toObject:function(c){return b(this.callSuper("toObject",c),{src:this._originalImage.src||this._originalImage._src,filters:this.filters.concat()})},toSVG:function(){return'<g transform="'+this.getSvgTransform()+'"><image xlink:href="'+this.getSvgSrc()+'" style="'+this.getSvgStyles()+'" transform="translate('+(-this.width/2)+" "+(-this.height/2)+')" width="'+this.width+'" height="'+this.height+'"></image></g>'},getSrc:function(){return this.getElement().src||this.getElement()._src},toString:function(){return'#<fabric.Image: { src: "'+this.getSrc()+'" }>'},clone:function(d,c){this.constructor.fromObject(this.toObject(c),d)},applyFilters:function(i){if(this.filters.length===0){this.setElement(this._originalImage);i&&i();return}var c=typeof Buffer!=="undefined"&&typeof window==="undefined",g=this._originalImage,e=fabric.util.createCanvasElement(),f=c?new (require("canvas").Image)():fabric.document.createElement("img"),h=this;e.width=g.width;e.height=g.height;e.getContext("2d").drawImage(g,0,0,g.width,g.height);this.filters.forEach(function(j){j&&j.applyTo(e)});f.onload=function(){h._element=f;i&&i();f.onload=e=g=null};f.width=g.width;f.height=g.height;if(c){var d=e.toDataURL("image/png").substring(22);f.src=new Buffer(d,"base64");h._element=f;i&&i()}else{f.src=e.toDataURL("image/png")}return this},_render:function(c){c.drawImage(this._element,-this.width/2,-this.height/2,this.width,this.height)},_resetWidthHeight:function(){var c=this.getElement();this.set("width",c.width);this.set("height",c.height)},_initElement:function(c){this.setElement(fabric.util.getById(c));fabric.util.addClass(this.getElement(),fabric.Image.CSS_CANVAS)},_initConfig:function(c){c||(c={});this.setOptions(c);this._setWidthHeight(c)},_initFilters:function(c){if(c.filters&&c.filters.length){this.filters=c.filters.map(function(d){return d&&fabric.Image.filters[d.type].fromObject(d)})}},_setWidthHeight:function(c){this.width="width" in c?c.width:(this.getElement().width||0);this.height="height" in c?c.height:(this.getElement().height||0)},complexity:function(){return 1}});fabric.Image.CSS_CANVAS="canvas-img";fabric.Image.prototype.getSvgSrc=fabric.Image.prototype.getSrc;fabric.Image.fromObject=function(d,f){var c=fabric.document.createElement("img"),e=d.src;if(d.width){c.width=d.width}if(d.height){c.height=d.height}c.onload=function(){fabric.Image.prototype._initFilters.call(d,d);var g=new fabric.Image(c,d);f&&f(g);c=c.onload=c.onerror=null};c.onerror=function(){fabric.log("Error loading "+c.src);f&&f(null,true);c=c.onload=c.onerror=null};c.src=e};fabric.Image.fromURL=function(c,e,d){fabric.util.loadImage(c,function(f){e(new fabric.Image(f,d))})};fabric.Image.ATTRIBUTE_NAMES="x y width height fill fill-opacity opacity stroke stroke-width transform xlink:href".split(" ");fabric.Image.fromElement=function(d,f,c){var e=fabric.parseAttributes(d,fabric.Image.ATTRIBUTE_NAMES);fabric.Image.fromURL(e["xlink:href"],f,b((c?fabric.util.object.clone(c):{}),e))};fabric.Image.async=true})(typeof exports!=="undefined"?exports:this);